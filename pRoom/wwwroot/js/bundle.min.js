function setHost(){board.isHost==1?(console={},console.log=function(){},console.warn=function(){},console.info=function(){},console.Error=function(){},console.error=function(){},console.debug=function(){},window.console=console):board.isHost=0}function setZoom(n,t){var i;transformOrigin=[0,0];t=t||instance.getContainer();var r=["webkit","moz","ms","o"],u="scale("+n+")",f=transformOrigin[0]*100+"% "+transformOrigin[1]*100+"%";for(i=0;i<r.length;i++)t.style[r[i]+"Transform"]=u;t.style.transform=u}function setZoomOUT(){var n=90*board.zoomScale/100,t;board.zoomScale=n;t=document.getElementById("boardContainer");setZoom(n,t);setToolbarPosation()}function setZoomIN(){var n=110*board.zoomScale/100,t;board.zoomScale=n;t=document.getElementById("boardContainer");setZoom(n,t);setToolbarPosation()}function showVal(n){var t=Number(n)/10,i=document.getElementById("whiteboardContainer");setZoom(t,i)}function mmm(){whiteboard.addConvas("#whiteboardContainer")}function preConvas(){var n=whiteboard.num-1;whiteboard.activeConvas(n)}function nextConvas(){var n=whiteboard.num+1;whiteboard.activeConvas(n)}function toPage(n){board.user.permission.toolBox&&(p={type:"board",action:"pageSelect",p:n,f:bboard.fileID,m:""},mainApp.sendToServer(p))}function createBoardPaging(n){for(var r,i="",t=1;t<=n;t++)r='<option value="'+(t-1)+'">'+t+"<\/option>",r="<option value="+(t-1)+">"+t+"<\/option>",i=i+r;i+="<\/ui>";document.getElementById("inputGroupSelect04").innerHTML=i}function prevPage(){var t=document.getElementById("inputGroupSelect04").value,n=parseInt(t);n!=0&&toPage(n-1)}function nextPage(){var t=document.getElementById("inputGroupSelect04").value,n=parseInt(t)+1,i=bboard.fileList[bboard.fileID];n<i.pageCount&&toPage(n)}function showToolbar(n){if(board.publish&&$(".screanShareIcon").css("display","block"),webRtcControler.permission(n),n.toolBox==0&&document.getElementsByTagName("body")[0].classList.remove("boardEditor"),n.toolBox==1&&document.getElementsByTagName("body")[0].classList.add("boardEditor"),bboard.changePage(bboard.pageID),n.file==0&&document.getElementsByTagName("body")[0].classList.remove("file"),n.file==1&&document.getElementsByTagName("body")[0].classList.add("file"),n.chat==0&&(document.getElementById("chatInputPanel").style.display="none"),n.chat==1&&(document.getElementById("chatInputPanel").style.display="block"),n.diagram==0&&$(".diagramIcon").css("display","none"),n.diagram==1&&$(".diagramIcon").css("display","block"),n.MathEditor==0){try{document.getElementsByClassName("MathEditorIcon")[0].style.display="none"}catch{}$(".MathEditorIcon").css("display","none")}if(n.MathEditor==1&&$(".MathEditorIcon").css("display","block"),n.Develop==0){try{document.getElementsByClassName("MathEditorIcon")[0].style.display="none"}catch{}$(".developPanelIcon").css("display","none")}if(n.Develop==1&&$(".developPanelIcon").css("display","block"),n.offic==0)try{document.getElementsByTagName("body")[0].classList.remove("offic")}catch{}if(n.offic==1&&document.getElementsByTagName("body")[0].classList.add("offic"),n.Record)try{document.getElementById("recordButton").style.display="block"}catch{}else try{document.getElementById("recordButton").style.display="none"}catch{}}function setChatPanel(){var n=62,i;board.isMobile&&(n=65);var t=$("#chatPanel").height()-n,r=document.getElementById("chatContiner"),u=t+"px";r.style.height=u;i=document.getElementById("userPanel");i.style.height=t+26+"px"}function gotDevices(n){return;const t=selectors.map(n=>n.value)}function gotStream(){}function handleError(n){console.log("navigator.MediaDevices.getUserMedia error: ",n.message,n.name)}function startdevice(){window.stream&&window.stream.getTracks().forEach(n=>{n.stop()});const n={audio:{deviceId:device.audioDevice?{exact:device.audioDevice}:undefined},video:{deviceId:device.videoDevice?{exact:device.videoDevice}:undefined}};board.user.permission.video||(n.video=!1);board.user.permission.audio||(n.audio=!1);console.log(n);navigator.mediaDevices.getUserMedia(n).then(gotStream).then(gotDevices)}function getBase64(n){return new Promise((t,i)=>{const r=new FileReader;r.readAsDataURL(n);r.onload=()=>{const i=r.result.replace("data:","").replace(/^.+,/,"");let n=r.result.toString().replace(/^data:(.*,)?/,"");n.length%4>0&&(n+="=".repeat(4-n.length%4));t(i)};r.onerror=n=>i(n)})}async function startFileUpload(){var i,r,n,t;if(document.querySelector("#file-input").files.length==0){alert("Error : No file selected");return}if(i=document.querySelector("#file-input").files[0],r=["image/jpeg","image/png","application/pdf","application/x-pdf"],r.indexOf(i.type)==-1){alert("Error : Incorrect file type");return}document.getElementById("fileUploadMessage").innerHTML=board.translate.fileManagement_startUpload;document.getElementById("loadFileXml").style.display="none";n=new FormData;n.append("from",mainApp.meetInfo.userName);n.append("meetID",mainApp.meetInfo.meetID);n.append("files",document.querySelector("#file-input").files[0]);t=new XMLHttpRequest;t.open("post","/fileUp/uploadFile");t.upload.addEventListener("progress",function(n){var t=n.loaded/n.total*100;t+="  ";document.getElementById("fileUploadMessage").innerHTML=board.translate.fileManagement_startUpload+" : "+t.substring(0,3)+" %"});t.addEventListener("load",function(){document.getElementById("fileUploadMessage").innerHTML=board.translate.fileManagement_uploadComplate});t.send(n);document.querySelector("#file-input").value=""}function startFileOfficUpload(){var t,i,r,n;if(document.querySelector("#file-offic-input").files.length==0){alert("Error : No file selected");return}if(t=document.querySelector("#file-offic-input").files[0],console.log(t),console.log(t.name),console.log(t.type),i=t.name.split(".").pop().toUpperCase(),console.log(i),officControler.WordFile.indexOf(i)==-1&&officControler.PowerPointFile.indexOf(i)==-1&&officControler.ExcelFile.indexOf(i)==-1){document.getElementById("fileOfficUploadMessage").innerHTML="Error : Incorrect file type";console.log("Error : Incorrect file type");return}document.getElementById("fileOfficUploadMessage").innerHTML=board.translate.fileManagement_startUpload;r=new FormData;r.append("from",mainApp.meetInfo.userName);r.append("meetID",mainApp.meetInfo.meetID);r.append("files",document.querySelector("#file-offic-input").files[0]);n=new XMLHttpRequest;n.open("post","/fileUp/uploadOfficFile");n.upload.addEventListener("progress",function(n){var t=n.loaded/n.total*100;console.log(t)});n.addEventListener("load",function(){document.getElementById("fileOfficUploadMessage").innerHTML=n.response=="ok"?board.translate.fileManagement_uploadComplate:"error in upload";setTimeout(function(){document.getElementById("fileOfficUploadMessage").innerHTML=""},5e3)});n.send(r);document.querySelector("#file-offic-input").value=""}function uploadFiles(n){var r=document.getElementById(n),i=r.files,t;i.length<1||(t=new FormData,t.append("files",i[0]),t.append("from",mainApp.meetInfo.userName),t.append("meetID",mainApp.meetInfo.meetID),console.log(t),$.ajax({url:"/fileUp/uploadFile",data:t,processData:!1,contentType:!1,type:"POST",success:function(n){var t=JSON.parse(n);console.log(t);document.getElementById("fileUploadMessage").innerHTML="upload complate";setTimeout(function(){document.getElementById("fileUploadMessage").innerHTML=""},5e3)}}),document.getElementById("fileUploadMessage").innerHTML="file upload start .......")}function uploadimgs(n){for(var u=document.getElementById(n),r=u.files,t=new FormData,i=0;i!=r.length;i++)t.append("files",r[i]);t.append("from",mainApp.meetInfo.userName);t.append("fileID",bboard.fileID);t.append("meetID",mainApp.meetInfo.meetID);t.append("pageID",bboard.pageID);console.log(t);$.ajax({url:"/fileUp/uploadImg",data:t,processData:!1,contentType:!1,type:"POST",success:function(n){var t=JSON.parse(n);console.log(t)}})}function is_touch_device1(){return"ontouchstart"in window}function joinShRoom(){OV2=new OpenVidu;OV2.setAdvancedConfiguration({iceServers:[{url:"stun:stun.freeswitch.org"},{urls:"turns:r2.salampnu.com:443?transport=tcp",username:"ali",credential:"ali"}]});session2=OV2.initSession();session2.on("connectionCreated",function(){});session2.on("connectionDestroyed",function(){});session2.on("streamCreated",function(n){var t;if(n.stream.typeOfVideo=="SCREEN")if(session3!=0&&n.stream.connection.connectionId==session3.connection.connectionId)console.warn("this is local chreen ; ");else{t=session2.subscribe(n.stream,"screenShareElemnt");t.on("videoElementCreated",function(){connectToScreenShare()});t.on("videoElementDestroyed",function(){screenControler.disconnectFromScreenShare();panelControler.activeBoard()})}else{subscriber2=session2.subscribe(n.stream,"videos");subscriber2.on("videoElementCreated",function(){numOfVideos++;updateLayout()});subscriber2.on("videoElementDestroyed",function(){})}});session2.on("streamDestroyed",function(){});session2.on("signal",()=>{});getToken(AsessionId).then(n=>{session2.connect(n).then(()=>{}).catch(n=>{console.log("There was an error connecting to the session:",n.code,n.message)})})}function startScreenShare1000(){if(screenControler.screenShareRemoteStatus){console.log("screenShareRemoteStatus = 1;");return}iconDisablVidu(6e3,MainNavBar);iconDisablVidu(6e3,iconViduPanel);publishScreen();return}function kkk(){intervalIDkkk=2;console.log("bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb.....................................................................");return}function _viduModulStart(){boardHtmlpanel=document.getElementById("boardHtmlpanel");screenSharePanel=document.getElementById("screenSharePanel")}function resizingVideoBox(){var t,i,n;return}function bestMatchCalculate(n,t,i){var u=Math.max(n,t),r=Math.min(n,t),o=Math.round(u/r),s=i*o,f=Math.ceil(Math.sqrt(s)),e=u/f,h=Math.ceil(i/f),c=r/h;return i==1&&(e=r),Math.min(c,e)}function isOdd(n){return n%2}function pdfFileClick(){}function boardClick(){var n=mainApp.sendToServer({type:"panelControler",action:"board"})}function moveCenterPanel(){if(layout.sessionPanelPosetion==2){var t=$("#screenSharePanel").height(),i=$(window).height(),n=i-(t+90);n>180&&(n>500&&(n=500),document.getElementById("newVideosBox").style.height=n+"px");resizingVideoBox()}}function moveBoardPanel(){if(layout.sessionPanelPosetion==2){var t=$("#boardContainer").height()*board.zoom,i=$(window).height(),n=i-(t+90);n>180&&(n>500&&(n=500),document.getElementById("newVideosBox").style.height=n+"px");resizingVideoBox()}}function initNewBoard(){var t,n;idroo.board.unlock();idroo.board.init();t={nr:6,id:1218010,pic:null,name:"javad6",mouse:[0,0],active:[]};idroo.board.editors[t.nr]=t;n="own";ui.toolbar.setLevel(n);ui.aside.setLevel(n);ui.clipboard.setLevel(n);ui.keyboard.setLevel(n);ui.phone.setLevel(n)}function resizeNewBoard(){var r,c,u,e,f,t;if(panelControler.activePanel=="board"){var s=document.getElementById("newBoard2"),h=document.getElementById("newBoard"),n=document.getElementById("boardContainer");setZoom(1,n);board.zoomScale2=1;r=$(window).width();c=$(window).height()-67;r=r-layout.rightPanelwidth;u=$("#screenAndBoard").width()-0;setZoom(1,n);e=document.getElementById("uiToolbar");f=document.getElementById("canvas");e.style.width=u+0+"px";f.style.width=board.width+"px";f.style.height=board.height+"px";n.style.height=board.height+"px";n.style.width=board.width+"px";initNewBoard();t=$("#screenAndBoard").height()-32;board.user.permission.toolBox;s.style.height=t+"px";h.style.height=t+"px";var l=(u-2)/board.width,o=(t-2)/board.height,i=l;o<i&&(i=o);n.style.pointerEvents=board.user.permission.toolBox?"all":"none";setZoom(i,n);board.zoomScale=i;setToolbarPosation()}}function setToolbarPosation(){var u;board.user.permission.toolBox;var t=document.getElementById("boardContainer"),i=$("#screenAndBoard").width()-0,f=$("#screenAndBoard").height()-32,n=document.getElementById("toolbar");let r=$("#boardContainer").width()+6;if(i>r)u=Math.min(i-r,30),t.style.marginLeft=u+"px",n.style.width="28px",n.style.top="30px";else{let i=$("#boardContainer").height()+30;f>i?(n.style.width="100%",n.style.top=i+2+"px"):(n.style.width="28px",n.style.top="30px");t.style.marginLeft="0px"}}function fff(n,t,i,r,u){if(console.log("fff"),n())return t(),"ok";if(u>1)setTimeout(()=>{fff(n,r,u-1)},r);else return i(),"no"}function getWithboardeData(){}function is_touch_enabled(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function mobileAndTabletcheck(){var n=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(n=!0)}(navigator.userAgent||navigator.vendor||window.opera),n}function reportWindowSize(){layout.reLoad(!1)}function ddd(){var r=document.createElement("script"),i,n;r.src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.2.0/fabric.min.js";console.log("start ..");var u=document.getElementById("id_viewer"),t=u.getContext("2d"),f=new fabric.Canvas("id_viewer"),e=f.getActiveObject();console.log(e.type);t.font="20px Arial";i="این یک آزمایش است.‏";n="‮";n+="این یک آزمایش است.";n+="‬";t.fillText(i,200,30);t.fillText(n,200,70)}function sleep(n){return new Promise(t=>setTimeout(t,n))}function load_script_promise(n){return new Promise(function(t){var r=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript";i.addEventListener("load",function(){this.removeEventListener("load",arguments.callee);t(i)});i.src=n;r.appendChild(i)})}var userManager,raiseHand,zoomScale2,mainApp,CBoard,selectors,fileService,intervalIDkkk,bboard,playerBoard,MainNavBar,vPlayer,recordControler,signalmessenger;(function(n){function a(){do f=2147483647>f?f+1:0;while(t[e](f));return f}var i,t={},r=window,u=console,y=Math,o="postMessage",s="HackTimer.js by turuslan: ",h="Initialisation failed",f=0,e="hasOwnProperty",c=[].slice,l=r.Worker;if(!/MSIE 10/i.test(navigator.userAgent))try{n=r.URL.createObjectURL(new Blob(["var f={},p=postMessage,r='hasOwnProperty';onmessage=function(e){var d=e.data,i=d.i,t=d[r]('t')?d.t:0;switch(d.n){case'a':f[i]=setInterval(function(){p(i)},t);break;case'b':if(f[r](i)){clearInterval(f[i]);delete f[i]}break;case'c':f[i]=setTimeout(function(){p(i);if(f[r](i))delete f[i]},t);break;case'd':if(f[r](i)){clearTimeout(f[i]);delete f[i]}break}}"]))}catch(v){}if(typeof l!="undefined")try{i=new l(n);r.setInterval=function(n,r){var u=a();return t[u]={c:n,p:c.call(arguments,2)},i[o]({n:"a",i:u,t:r}),u};r.clearInterval=function(n){t[e](n)&&(delete t[n],i[o]({n:"b",i:n}))};r.setTimeout=function(n,r){var u=a();return t[u]={c:n,p:c.call(arguments,2),t:!0},i[o]({n:"c",i:u,t:r}),u};r.clearTimeout=function(n){t[e](n)&&(delete t[n],i[o]({n:"d",i:n}))};i.onmessage=function(n){var o=n.data,i,f;if(t[e](o)&&(f=t[o],i=f.c,f[e]("t")&&delete t[o]),typeof i=="string")try{i=new Function(i)}catch(h){u.log(s+"Error parsing callback code string: ",h)}typeof i=="function"&&i.apply(r,f.p)};i.onerror=function(n){u.log(n)};u.log(s+"Initialisation succeeded")}catch(v){u.log(s+h);u.error(v)}else u.log(s+h+" - HTML5 Web Worker is not supported")})("HackTimerWorker.min.js"),function(n,t){typeof define=="function"&&define.amd?define(["./ResizeSensor.js"],t):typeof exports=="object"?module.exports=t(require("./ResizeSensor.js")):(n.ElementQueries=t(n.ResizeSensor),n.ElementQueries.listen())}(typeof window!="undefined"?window:this,function(n){var t=function(){function e(n){n||(n=document.documentElement);var t=window.getComputedStyle(n,null).fontSize;return parseFloat(t)||16}function c(n){if(!n.getBoundingClientRect)return{width:n.offsetWidth,height:n.offsetHeight};var t=n.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function l(n,t){var i=t.split(/\d/),r=i[i.length-1];t=parseFloat(t);switch(r){case"px":return t;case"em":return t*e(n);case"rem":return t*e();case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var u=document.documentElement.clientWidth/100,f=document.documentElement.clientHeight/100,o=Math[r==="vmin"?"min":"max"];return t*o(u,f);default:return t}}function a(n,i){this.element=n;var s,r,h,a,v,u,f,o,e=["min-width","min-height","max-width","max-height"];this.call=function(){h=c(this.element);u={};for(s in t[i])t[i].hasOwnProperty(s)&&(r=t[i][s],a=l(this.element,r.value),v=r.property==="width"?h.width:h.height,o=r.mode+"-"+r.property,f="",r.mode==="min"&&v>=a&&(f+=r.value),r.mode==="max"&&v<=a&&(f+=r.value),u[o]||(u[o]=""),f&&-1===(" "+u[o]+" ").indexOf(" "+f+" ")&&(u[o]+=" "+f));for(var n in e)e.hasOwnProperty(n)&&(u[e[n]]?this.element.setAttribute(e[n],u[e[n]].substr(1)):this.element.removeAttribute(e[n]))}}function o(t,i){t.elementQueriesSetupInformation||(t.elementQueriesSetupInformation=new a(t,i));t.elementQueriesSensor||(t.elementQueriesSensor=new n(t,function(){t.elementQueriesSetupInformation.call()}))}function v(n,u,f,e){if(typeof t[n]=="undefined"){t[n]=[];var o=r.length;i.innerHTML+="\n"+n+" {animation: 0.1s element-queries;}";i.innerHTML+="\n"+n+" > .resize-sensor {min-width: "+o+"px;}";r.push(n)}t[n].push({mode:u,property:f,value:e})}function s(n){var t;if(document.querySelectorAll&&(t=n?n.querySelectorAll.bind(n):document.querySelectorAll.bind(document)),t||"undefined"==typeof $$||(t=$$),t||"undefined"==typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}function y(n){var e=s(n),i,u,r,f;for(i in t)if(t.hasOwnProperty(i))for(u=e(i,n),r=0,f=u.length;r<f;r++)o(u[r],i)}function p(t){function a(){var n=!1,i,s;for(i in r)r.hasOwnProperty(i)&&e[i].minWidth&&t.offsetWidth>e[i].minWidth&&(n=i);n||(n=o);u!==n?h[n]?(r[u].style.display="none",r[n].style.display="block",u=n):(s=new Image,s.onload=function(){r[n].src=f[n];r[u].style.display="none";r[n].style.display="block";h[n]=!0;u=n},s.src=f[n]):r[n].src=f[n]}var r=[],e=[],f=[],o=0,u=-1,h=[],i,s,c,l;for(i in t.children)t.children.hasOwnProperty(i)&&t.children[i].tagName&&t.children[i].tagName.toLowerCase()==="img"&&(r.push(t.children[i]),s=t.children[i].getAttribute("min-width")||t.children[i].getAttribute("data-min-width"),c=t.children[i].getAttribute("data-src")||t.children[i].getAttribute("url"),f.push(c),l={minWidth:s},e.push(l),s?t.children[i].style.display="none":(o=r.length-1,t.children[i].style.display="block"));u=o;t.resizeSensorInstance=new n(t,a);a()}function w(){for(var i=s(),t=i("[data-responsive-image],[responsive-image]"),n=0,r=t.length;n<r;n++)p(t[n])}function u(n){var t,r,u,i;for(n=n.replace(/'/g,'"');null!==(t=b.exec(n));)for(r=t[1]+t[3],u=t[2];null!==(i=k.exec(u));)v(r,i[1],i[2],i[3])}function f(n){var i="",t,r;if(n)if("string"==typeof n)n=n.toLowerCase(),(-1!==n.indexOf("min-width")||-1!==n.indexOf("max-width"))&&u(n);else for(t=0,r=n.length;t<r;t++)1===n[t].type?(i=n[t].selectorText||n[t].cssText,-1!==i.indexOf("min-height")||-1!==i.indexOf("max-height")?u(i):(-1!==i.indexOf("min-width")||-1!==i.indexOf("max-width"))&&u(i)):4===n[t].type?f(n[t].cssRules||n[t].rules):3===n[t].type&&n[t].styleSheet.hasOwnProperty("cssRules")&&f(n[t].styleSheet.cssRules)}var i,t={},r=[],b=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/mgi,k=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/mgi,h=!1;this.init=function(){var u="animationstart",t,e;for(typeof document.documentElement.style.webkitAnimationName!="undefined"?u="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName!="undefined"?u="mozanimationstart":typeof document.documentElement.style.OAnimationName!="undefined"&&(u="oanimationstart"),document.body.addEventListener(u,function(t){var i=t.target,f=i&&window.getComputedStyle(i,null),e=f&&f.getPropertyValue("animation-name"),h=e&&-1!==e.indexOf("element-queries"),s,u;h&&(i.elementQueriesSensor=new n(i,function(){i.elementQueriesSetupInformation&&i.elementQueriesSetupInformation.call()}),s=window.getComputedStyle(i.resizeSensor,null),u=s.getPropertyValue("min-width"),u=parseInt(u.replace("px","")),o(t.target,r[u]))}),h||(i=document.createElement("style"),i.type="text/css",i.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",i.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(i),h=!0),t=0,e=document.styleSheets.length;t<e;t++)try{document.styleSheets[t].href&&0===document.styleSheets[t].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[t].href);f(document.styleSheets[t].cssRules||document.styleSheets[t].rules||document.styleSheets[t].cssText)}catch(s){}w()};this.findElementQueriesElements=function(n){y(n)};this.update=function(){this.init()}},i;return t.update=function(){t.instance.update()},t.detach=function(n){n.elementQueriesSetupInformation?(n.elementQueriesSensor.detach(),delete n.elementQueriesSetupInformation,delete n.elementQueriesSensor):n.resizeSensorInstance&&(n.resizeSensorInstance.detach(),delete n.resizeSensorInstance)},t.init=function(){t.instance||(t.instance=new t);t.instance.init()},i=function(n){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(n(),clearInterval(t))},10);else window.onload=n},t.findElementQueriesElements=function(n){t.instance.findElementQueriesElements(n)},t.listen=function(){i(t.init)},t}),function(n,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"?module.exports=t():n.ResizeSensor=t()}(typeof window!="undefined"?window:this,function(){function u(n,t){var i=Object.prototype.toString.call(n),u="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&n instanceof jQuery||"undefined"!=typeof Elements&&n instanceof Elements,r=0,f=n.length;if(u)for(;r<f;r++)t(n[r]);else t(n)}function f(n){if(!n.getBoundingClientRect)return{width:n.offsetWidth,height:n.offsetHeight};var t=n.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function n(n,t){Object.keys(t).forEach(function(i){n.style[i]=t[i]})}var i,r,t,e;return typeof window=="undefined"?null:(i=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),r=i.requestAnimationFrame||i.mozRequestAnimationFrame||i.webkitRequestAnimationFrame||function(n){return i.setTimeout(n,20)},t=function(i,e){function o(){var t=[],n,i;this.add=function(n){t.push(n)};this.call=function(r){for(n=0,i=t.length;n<i;n++)t[n].call(this,r)};this.remove=function(r){var u=[];for(n=0,i=t.length;n<i;n++)t[n]!==r&&u.push(t[n]);t=u};this.length=function(){return t.length}}function s(t,i){var c,y,u,h,e,l,p,a;if(t){if(t.resizedAttached){t.resizedAttached.add(i);return}t.resizedAttached=new o;t.resizedAttached.add(i);t.resizeSensor=document.createElement("div");t.resizeSensor.dir="ltr";t.resizeSensor.className="resize-sensor";c={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"};y={position:"absolute",left:"0px",top:"0px",transition:"0s"};n(t.resizeSensor,c);u=document.createElement("div");u.className="resize-sensor-expand";n(u,c);h=document.createElement("div");n(h,y);u.appendChild(h);e=document.createElement("div");e.className="resize-sensor-shrink";n(e,c);l=document.createElement("div");n(l,y);n(l,{width:"200%",height:"200%"});e.appendChild(l);t.resizeSensor.appendChild(u);t.resizeSensor.appendChild(e);t.appendChild(t.resizeSensor);p=window.getComputedStyle(t);a=p?p.getPropertyValue("position"):null;"absolute"!==a&&"relative"!==a&&"fixed"!==a&&(t.style.position="relative");var w,b,s=f(t),d=0,g=0,nt=!0,k=0,rt=function(){var n=t.offsetWidth,i=t.offsetHeight;h.style.width=n+10+"px";h.style.height=i+10+"px";u.scrollLeft=n+10;u.scrollTop=i+10;e.scrollLeft=n+10;e.scrollTop=i+10},v=function(){if(nt){var n=t.offsetWidth===0&&t.offsetHeight===0;if(n){k||(k=r(function(){k=0;v()}));return}nt=!1}rt()};t.resizeSensor.resetSensor=v;var ut=function(){(b=0,w)&&(d=s.width,g=s.height,t.resizedAttached&&t.resizedAttached.call(s))},tt=function(){s=f(t);w=s.width!==d||s.height!==g;w&&!b&&(b=r(ut));v()},it=function(n,t,i){n.attachEvent?n.attachEvent("on"+t,i):n.addEventListener(t,i)};it(u,"scroll",tt);it(e,"scroll",tt);r(v)}}u(i,function(n){s(n,e)});this.detach=function(n){t.detach(i,n)};this.reset=function(){i.resizeSensor.resetSensor()}},t.reset=function(n){u(n,function(n){n.resizeSensor.resetSensor()})},t.detach=function(n,t){u(n,function(n){n&&(n.resizedAttached&&typeof t=="function"&&(n.resizedAttached.remove(t),n.resizedAttached.length())||n.resizeSensor&&(n.contains(n.resizeSensor)&&n.removeChild(n.resizeSensor),delete n.resizeSensor,delete n.resizedAttached))})},typeof MutationObserver!="undefined"&&(e=new MutationObserver(function(n){var u,r,i;for(u in n)if(n.hasOwnProperty(u))for(r=n[u].addedNodes,i=0;i<r.length;i++)r[i].resizeSensor&&t.reset(r[i])}),document.addEventListener("DOMContentLoaded",function(){e.observe(document.body,{childList:!0,subtree:!0})})),t)});userManager={userDic:null,firstPermission:!0,activeUserForPermission:null,DefaultPermission:{video:0,audio:0,toolBox:0,file:0,chat:1,screen:0,diagram:0,MathEditor:0,offic:1},parse:function(n){var i=n.action,t;switch(i){case"newUser":userManager.newUser(n);break;case"userList":userManager.setUserList(n);break;case"offlineUser":userManager.offlineUser(n);break;case"onlineUser":t=n.activePanel;t!=null&&t!=undefined&&panelControler.prseAction(t);userManager.syncUserList(n.userList);break;case"exit":meetManager.exit();break;case"reload":userManager.reload(n);break;case"permission":userManager.permission(n);break;case"DefaultPermission":userManager.setDefaultPermission(n);break;case"addStream":userManager.addStream(n);break;case"removeStream":userManager.removeStream(n);break;case"raiseHand":raiseHand.recive(n)}},syncUserList:function(n){var o={},s={},h,t,i,r,u,f,e;for(t in userManager.userDic)n[t]||(o[t]=1);for(t in n)userManager.userDic[t]||(s[t]=1);for(t in o)if(h=userManager.userDic[t],h.isRecorder)recordControler.setRecordeStatus(0);else try{document.getElementById("user_"+t).remove()}catch(c){console.log("user remove error 111")}for(t in s)i=n[t],i.isRecorder?recordControler.setRecordeStatus(1):(r=userManager.getUserHtmlDiv(i),u=document.getElementById("userPanel"),console.log(i),i.role?(f=u.childNodes[0],f?(e=document.createElement("div"),e.innerHTML=r,f.insertAdjacentElement("afterend",e)):u.innerHTML+=r):u.innerHTML+=r);userManager.userDic=n},setUserList:function(n){userManager.userDic=n;userManager.renderUserList(n)},renderUserList:function(n){var u=n,i="",f="",e=0,o,t,r,s,h;for(o in u){if(t=u[o],t.isRecorder&&!t.isOffLine){e=1;continue}r=userManager.getUserHtmlDiv(t);t.name==board.userName?(s={user:t},this.permission(s),f=r):t.role?i=r+i:i+=r}i=f+i;h=document.getElementById("userPanel");recordControler.setRecordeStatus(e);h.innerHTML=i},newUser:function(n){var t,e,i,r,u,f;if(userManager.userDic!=undefined&&userManager.userDic!=null&&(t=n.user,e=userManager.userDic[t.name],e==undefined)){if(userManager.userDic[t.name]=t,t.isRecorder){recordControler.setRecordeStatus(1);return}i=userManager.getUserHtmlDiv(t);r=document.getElementById("userPanel");t.role?(u=r.childNodes[0],u?(f=document.createElement("div"),f.innerHTML=i,u.insertAdjacentElement("afterend",f)):r.innerHTML+=i):r.innerHTML+=i}},getUserHtmlDiv:function(n){var r,i,t;return n.isOffLine?(delete userManager.userDic[n.name],""):n.nickname=="ali771"?"":(r="user_"+n.name,i="",board.publish&&(i="onclick=\"userManager.userClick('"+n.name+"')\" "),t="<div class='sUserItem'   id='"+r+"' "+i+">",t+="<div class='sUserItemChild sUserItemFchild'><span class='userListItemIcon' >",t+=n.role?"<i class='fas fa-user-edit'><\/i>":"<i class='fas fa-user-graduate userListItemIconT'><\/i>",t+="<\/span>",t+="<span>"+n.nickname,t+=" <\/span><\/div>",t+"<\/div>")},addStream:function(n){var i,r;userManager.removeStream(n);var t=n.meetInfo.userName,f=n.video,u=document.getElementById("user_"+t);u&&(i=document.createElement("i"),i.className=f?"fas fa-video":"fas fa-microphone",i.id="streamIcon_"+t,u.appendChild(i));r=userManager.userDic[t];r&&(console.log("user found"),r.webrtcStream.streamId=n.streamId);webrtClient.streamDic[n.streamId]==undefined&&(webrtClient.streamDic[n.streamId]={name:t,isActive:0})},removeStream:function(n){var i="streamIcon_"+n.meetInfo.userName,t=document.getElementById(i);t&&t.parentNode.removeChild(t)},offlineUser:function(n){for(var t,r,i=0;i<n.userList.length;i++)if(t=n.userList[i].name,r=userManager.userDic[t],r!=undefined)if(r.isRecorder)recordControler.setRecordeStatus(0),delete userManager.userDic[t];else try{delete userManager.userDic[t];document.getElementById("user_"+t).remove()}catch(u){console.log("user remove error")}},userClick:function(n){var t,i;if(board.publish){if(n=="DefaultPermission")t=userManager.DefaultPermission,document.getElementById("userModalTitle").innerText=board.translate.DefaultPermission;else{if(i=userManager.userDic[n],i==undefined)return;document.getElementById("userModalTitle").innerText=board.translate.userPermisionTitle+i.nickname;t=i.permission}userManager.activeUserForPermission=n;$("#userModal").modal("toggle");document.getElementById("chek_permission_audio").checked=!1;document.getElementById("chek_permission_video").checked=!1;document.getElementById("chek_permission_toolBox").checked=!1;document.getElementById("chek_permission_file").checked=!1;document.getElementById("chek_permission_chat").checked=!1;document.getElementById("chek_permission_screen").checked=!1;document.getElementById("chek_permission_diagram").checked=!1;document.getElementById("chek_permission_MathEditor").checked=!1;document.getElementById("chek_permission_offic").checked=!1;document.getElementById("chek_permission_Develop").checked=!1;t.audio&&(document.getElementById("chek_permission_audio").checked=!0);t.video&&(document.getElementById("chek_permission_video").checked=!0);t.toolBox&&(document.getElementById("chek_permission_toolBox").checked=!0);t.file&&(document.getElementById("chek_permission_file").checked=!0);t.chat&&(document.getElementById("chek_permission_chat").checked=!0);t.screen&&(document.getElementById("chek_permission_screen").checked=!0);t.diagram&&(document.getElementById("chek_permission_diagram").checked=!0);t.MathEditor&&(document.getElementById("chek_permission_MathEditor").checked=!0);t.offic&&(document.getElementById("chek_permission_offic").checked=!0);t.Develop&&(document.getElementById("chek_permission_Develop").checked=!0)}},userPermissionModalSave:function(){var h=0,n,t,i,r,u,f,e,o,s,c;document.getElementById("chek_permission_audio").checked&&(h=1);n=0;document.getElementById("chek_permission_video").checked&&(n=1);t=0;document.getElementById("chek_permission_toolBox").checked&&(t=1);i=0;document.getElementById("chek_permission_file").checked&&(i=1);r=0;document.getElementById("chek_permission_chat").checked&&(r=1);u=0;document.getElementById("chek_permission_screen").checked&&(u=1);f=0;document.getElementById("chek_permission_diagram").checked&&(f=1);e=0;document.getElementById("chek_permission_MathEditor").checked&&(e=1);o=0;document.getElementById("chek_permission_offic").checked&&(o=1);s=0;document.getElementById("chek_permission_Develop").checked&&(s=1);c={type:"userManager",action:"permission",toUserName:userManager.activeUserForPermission,audio:h,video:n,toolBox:t,file:i,chat:r,screen:u,diagram:f,MathEditor:e,offic:o,Develop:s};mainApp.sendToServer(c)},permission:function(n,t){var i=n.user,r=i.name;if(userManager.userDic[r]=i,board.userName==r){t||(t=board.user.permission);board.permission=n;board.user=n.user;userManager.changUiByNewPermission(i.permission,t);return}},changUiByNewPermission:function(n,t){(!this.changeInPermission(t,n)||userManager.firstPermission)&&(userManager.firstPermission=!1,viduAppUi.renserToolbox(n),diagramControler.setPermissen(n.diagram),MathEditorControler.setPermissen(n.MathEditor),officControler.setPermissen(n.offic))},setDefaultPermission:function(n){var t,i;userManager.DefaultPermission=n.Permission;board.publish||(i=board.user.permission,t={user:board.user},t.user.permission=n.Permission,this.permission(t,i));return},changeInPermission:function(n,t){return n.audio==t.audio&&n.video==t.video&&n.chat==t.chat&&n.file==t.file&&n.screen==t.screen&&n.toolBox==t.toolBox&&n.diagram==t.diagram&&n.MathEditor==t.MathEditor&&n.offic==t.offic&&n.Develop==t.Develop?!0:!1},updateUser:function(n){var t=n.name;userManager.userDic[t]=n},reload:function(n){console.warn("reload");var t=new URL(window.location);n.x=="0"?t.searchParams.set("x","0"):t.searchParams.set("x","1");window.location.href==t.href?window.location.reload(!0):window.location.href=t.href}};const delayTime=n=>new Promise(t=>setTimeout(t,n));raiseHand={dic:{},raiseHandIcon:document.getElementById("raiseHandIcon"),raiseHandClick:async()=>{if(raiseHand.dic[board.userName]!=1){var n={type:"userManager",action:"raiseHand",user:board.userName};mainApp.sendToServer(n)}},recive:function(n){var t=n.user,r,i,u;this.dic[t]!=1&&(this.dic[t]=1,t==board.userName&&(this.raiseHandIcon.style.color="deepskyblue"),r=document.getElementById("user_"+t),r)&&(i=document.createElement("div"),i.className="sUserItemChild sUserItemSchild",u=document.createElement("i"),u.classList="far fa-hand-peace",i.appendChild(u),r.appendChild(i),board.publish&&this.raiseHandIcon.style.color!="red"&&t!=board.userName&&(this.raiseHandIcon.style.color="red",setTimeout(()=>{this.raiseHandIcon.style.color="darkgreen"},2e4)),setTimeout(()=>{try{i.remove()}catch(n){}this.dic[t]=0;t==board.userName&&(this.raiseHandIcon.style.color="darkgreen")},6e4))}};setHost();board.zoomScale2=1;zoomScale2=10;window.onload=function(){};mainApp={ddd:"ssssssss",meetInfo:{userName:board.userName,meetID:board.meetID},AppStatus:{connection:!1,reConecting:!1,isExit:!1},userName:"ali",protocol:location.protocol==="https:"?"wss:":"ws:",wsUri:null,socket:null,socketing:function(){mainApp.AppStatus.isExit||(protocol=location.protocol==="https:"?"wss:":"ws:",this.wsUri=protocol+"//"+window.location.host,this.socket?this.socket.close(3001):(document.cookie="ali=aaaaaaaaa ; path=/",this.socket=new WebSocket(this.wsUri),this.socket.onopen=()=>{this.AppStatus.connection=!0;var n={};n.type="join";n.reConecting=mainApp.AppStatus.reConecting;n.role=board.publish;this.sendToServer(n);this.AppStatus.reConecting&&$.notify({message:board.translate.ServerConnection},{placement:{from:"top",align:"left"},delay:3e3,type:"success"})},this.socket.onclose=function(n){mainApp.AppStatus.connection=!1;this.socket=n.code==3001?null:null},this.socket.onmessage=function(n){if(mainApp.AppStatus.connection&&!mainApp.AppStatus.isExit){var t=JSON.parse(n.data);switch(t.type){case"board":CBoard.parse(t);break;case"meetSatus":mainApp.handleMeetStatus(t);break;case"file":fileService.parse(t);break;case"activeFile":fileService.activeFile(t.fileID);break;case"textMessage":chatService.parse(t);break;case"userManager":userManager.parse(t);break;case"meetManager":meetManager.parse(t);break;case"quiz":quiz.parse(t);break;case"vPlayer":vPlayer.parse(t);break;case"panelControler":panelControler.parse(t);break;case"diagram":diagramControler.parse(t);break;case"MathEditor":MathEditorControler.parse(t);break;case"offic":officControler.parse(t)}}},this.socket.onerror=function(n){console.error(n.data);$.notify({message:board.translate.connectionLost},{placement:{from:"top",align:"left"},delay:3e3,type:"danger"})}))},handleMeetStatus:function(n){var r,t,u,f,e,i;board.MeetStatus=1;r=n.meet.chatMD.chatList;chatService.recivechatList(r);userManager.DefaultPermission=n.meet.permission;t=n.meet.filesModel.fileList;bboard.fileList=t;fileService.handelFileList(t);developControler.lastFile=n.meet.developMD.lastFile;u=n.meet.board.mList;f=n.meet.userManager.userDic;userManager.setUserList(f);bboard.mlistToDic(u);quiz.Preparation(n.meet.quizModel);vPlayer.firstLoad(n.meet.vPlayerModel);e=n.meet.activePanel;i=n.meet.diagramData.LastMessage;MathEditorControler.lastMessage=n.meet.MathEditorData.LastMessage;i!=""&&(diagramControler.lastMessage=JSON.parse(i));panelControler.prseAction(e);messageQueue.readAll();mqttClient.meetStatus=!0;board.token=n.token;webRtcControler.load();return},sendToServer:function(n){mainApp.AppStatus.isExit;n.meetInfo=this.meetInfo;mqttClient.send(JSON.stringify(n));return},sendPing:function(){this.sendToServer({type:"ping"})},interval2:function(){mainApp.sendPing()},start:function(){signalmessenger.connect();return},promisFunction:function(){var n=document.querySelector("video").play();n!==undefined&&n.then(()=>{}).catch(()=>{})}};CBoard={c:{x:200,y:100,r:10},first:!0,canvas:null,ctx:null,MousePointer:!1,parseMlist:function(){},parse:function(n){bboard.reciveMessage(n)},parseMouse:function(n){var i=n.m.m[0],r=n.m.m[1],t;CBoard.first&&(CBoard.first=!1,CBoard.canvas=document.getElementsByTagName("canvas")[3],CBoard.ctx=CBoard.canvas.getContext("2d"),CBoard.ctx.font="16px fontawesome");CBoard.c.x=i;CBoard.c.y=r;t=16/board.zoomScale;CBoard.ctx.font=t+"px fontawesome";CBoard.ctx.clearRect(0,0,CBoard.canvas.width,CBoard.canvas.height);CBoard.ctx.fillText(n.name,CBoard.c.x,CBoard.c.y)},activeMousePointer:function(n){console.log("mouse is active");board.shortName=board.nickName.substring(0,2);CBoard.MousePointer=!CBoard.MousePointer;n.style.color=CBoard.MousePointer?"red":"green"}};jQuery(document).ready(function(n){var t=n(".bs-canvas-overlay");n('[data-toggle="canvas"]').on("click",function(){var r=n(this),i=r.is("button")?r.data("target"):r.attr("href");return n(i).addClass("mr-0"),n(i+" .bs-canvas-close").attr("aria-expanded","true"),n('[data-target="'+i+'"], a[href="'+i+'"]').attr("aria-expanded","true"),t.length&&t.addClass("show"),!1});n(".bs-canvas-close").on("click",function(){var i;return n(this).hasClass("bs-canvas-close")?(i=n(this).closest(".bs-canvas"),n('[data-target="'+i+'"], a[href="'+i+'"]').attr("aria-expanded","false")):(i=n(".bs-canvas"),n('[data-toggle="canvas"]').attr("aria-expanded","false")),i.removeClass("mr-0"),n(".bs-canvas-close",i).attr("aria-expanded","false"),t.length&&t.removeClass("show"),!1});n(".bs-canvas-close, .bs-canvas-overlay").on("click",function(){return})});document.getElementById("menu-toggle").addEventListener("click",function(){chatService.unReadMessage=0;chatService.updateUnReadmessage()});var chatService={unReadMessage:0,messageIDfordelete:0,parse:function(n){var t=n.action;switch(t){case"new":chatService.reciveMessage(n);break;case"delete":chatService.deleteMessage(n)}},sendTextMessage:function(){var t=document.getElementById("chatInput"),r=document.getElementById("chatContiner"),n=t.value,i;if(n=n.trim(),n==""){t.value="";event.preventDefault();return}if(n=="dis"){signalmessenger.close();t.value="";event.preventDefault();return}if(n=="disrtc"){appActions.disconnectRoom();t.value="";event.preventDefault();return}return i={type:"textMessage",action:"new",nickName:board.nickName,text:n},mainApp.sendToServer(i),t.value="",event.preventDefault(),!1},reciveMessage:function(n){layout.id!=2||layout.menuStatus||chatService.unReadMessage++;chatService.updateUnReadmessage();var t=n.m.nickName,i=n.m.text;this.handelMessage(n.m.id,i,t,n.m.userName)},handelMessage:function(n,t,i,r){var u=document.getElementById("chatContiner");u.innerHTML+=chatService.getMessageHtml(n,t,i,r);chatService.scroolToEnd()},scroolToEnd:function(){var n=document.getElementById("chatContiner");n.scrollTop=n.scrollHeight},getMessageHtml:function(n,t,i,r){return"<div id=chatMassageItem_"+n+' class="chatMassageItem" ><p  class="chatMassageItemLine" > <strong onclick="userManager.userClick(\''+r+'\')" class="chatMassageUserName">'+i+"  :  <\/strong><normal id=chatMassageItemText_"+n+"> "+t+"<\/normal><strong onclick=\"chatService.editMessageView('"+n+'\')">   <i class="far fa-trash-alt chatMessageTextEdit"><\/i><\/strong><\/p><\/div>'},recivechatList:function(n){var i,u,r,t;for(document.getElementById("chatContiner").innerHTML="",i=document.getElementById("chatContiner"),u="",r=0;r<n.length;r++)t=n[r],t.isDelete||(u+=this.getMessageHtml(t.id,t.text,t.nickName,t.userName));i.innerHTML=u;i.scrollTop=i.scrollHeight;chatService.scroolToEnd()},updateUnReadmessage:function(){var n=document.getElementById("unReadMessage");n.innerText=chatService.unReadMessage?chatService.unReadMessage:""},editMessageView:function(n){if(board.publish){var t=document.getElementById("chatMassageItemText_"+n);t&&(this.messageIDfordelete=n,document.getElementById("messageForDelete").innerText=t.innerText,$("#messageModal").modal("toggle"))}},deleteMessageToServer:function(){var n;if(board.publish){n={type:"textMessage",action:"delete",id:this.messageIDfordelete};mainApp.sendToServer(n);return}},deleteMessage:function(n){var t=document.getElementById("chatMassageItem_"+n.id);t&&t.remove()}},deviceUnpublisher={save:function(){mainApp.start()}},iconDevicePanel=document.getElementById("iconDevicelPanel"),device={videoDevice:undefined,audioDevice:undefined,isClose:0,settings:function(){acquireDeviceList();$("#deviceJanusModal").modal("toggle");device.start()},save:function(){return},close:function(){return},start:function(){return}};"use strict";const audioInputSelect=document.querySelector("select#audioSource"),videoSelect=document.querySelector("select#videoSource"),selectorss=[audioInputSelect,videoSelect];selectors=[audioInputSelect];meetManager={parse:function(){},exit:function(){board.isRecorder&&parent.stopRecordier();mainApp.AppStatus.isExit=!0;setTimeout(function(){var n="/"+board.lang+"/room/start/"+board.meetID;window.location=n;return},1e3)},end:function(){}};const toBase64=n=>new Promise((t,i)=>{const r=new FileReader;r.readAsDataURL(n);r.onload=()=>t(r.result);r.onerror=n=>i(n)});fileService={fileList:null,openFilePanelModal:function(){$("#filePanelModal").modal("toggle")},parse:function(n){var t=n.action;switch(t){case"file":fileService.handleReciveFile(n);break;case"setImage":fileService.setImageParse(n)}},handelFileList:function(n){var u,f,i,r,t;fileService.fileList=n;try{for(u=document.getElementById("PdfFiletable"),f=u.rows.length,i=f-1;i>=0;i--)u.deleteRow(i)}catch(e){console.log(e)}for(r=0;r<n.length;r++)t=n[r],t.pageCount>0?fileService.renderFileToHtmlElement(board.meetID,t.inRoomID,t.name,t.ext):(console.warn("page count is 0 : "),console.log(t))},handleReciveFile:function(n){if(n.res!="ok"){setTimeout(function(){document.getElementById("fileUploadMessage").innerHTML="error in convert your file";document.getElementById("loadFileXml").style.display="block"},2e3);return}setTimeout(function(){document.getElementById("fileUploadMessage").innerHTML="convert complate";document.getElementById("loadFileXml").style.display="block"},2e3);var t={id:0,inRoomID:n.fileID,ext:n.ext,name:n.fileName,pageCount:n.pdfPageCount,width:n.width,height:n.height,d:null};bboard.addFileToDic(t);fileService.renderFileToHtmlElement(board.meetID,n.fileID,n.fileName,n.ext)},renderFileToHtmlElement:function(n,t,i,r){var s="/files/board/"+n+"/pdf/"+t+r;selectSpan='<a class="fileItem" href="#" onclick="fileService.activeFileServer('+t+',0)"  ><i class="fa fa-edit"  ><\/i> <\/a>';var o=document.getElementById("PdfFiletable"),h=o.rows.length,e=o.insertRow(h),u=e.insertCell(0),f="<span>"+t+"<\/span>";u.innerHTML=f;u=e.insertCell(1);u.innerHTML=selectSpan;u=e.insertCell(2);f="<span>"+i+"<\/span>";u.innerHTML=f;u=e.insertCell(3);f='<a href="'+s+'"  target="_blank"><i class="fas fa-download"><\/i><\/a>';u.innerHTML=f},activeFile:function(n){var t,i;if(n==0){defultSlide();return}for(t=0;t<fileService.fileList.length;t++)if(i=fileService.fileList[t],i.d.fileID==n){fileService.FileToBoard(i.d);return}},FileToBoard:function(n){console.log("file : "+n.pdfPageCount+" : "+n.pdfOrder+" w is "+n.width+" h is : "+n.height);prepareBoard(n.width,n.height);newPdf(n.pdfPageCount,n.pdfOrder)},activeFileServer:function(n){boardClick();var t={type:"board",action:"fileSelect",p:0,f:n,m:""};mainApp.sendToServer(t)},setImageParse:function(n){var t=n.action;switch(t){case"set":fileService.setImage(n);break;case"clearImage":fileService.clearImage(n)}},setImage:function(n){console.warn("setImage");var t="/files/board/"+board.meetID+"/img/"+n.fileID+"/"+n.imgId+".jpg";console.log(t);document.getElementById("whiteboardBG").style.backgroundImage="url("+t+")";console.log(n)},clearImage:function(n){console.warn("clearImage");document.getElementById("whiteboardBG").style.backgroundImage="none";console.log(n)},clearImageRequstToServer:function(){var n={type:"board",board:"draw",d:{t:"setImage",action:"clearImage",num:bboard.pageID,fileID:bboard.fileID,type:"board",board:"draw"}};console.log(n);mainApp.sendToServer(n)}};is_touch_device1()&&$(".toolbarHide").hide();var iconViduPanel=document.getElementById("iconPanelVidu"),publisher2,session2,OV2,session3=0,OV3,AsessionId="a"+board.meetID,boardHtmlpanel,screenSharePanel;intervalIDkkk=0;viduAppUi={mute_video:document.getElementById("mute-video-span"),mute_audio:document.getElementById("mute-audio-span"),device_settings_span:document.getElementById("device-settings-span"),renserToolbox:function(n){var t;showToolbar(n);return}};var boardControler={intervalID:null,pageId:0,sendMessage:1,click:function(){mainApp.sendToServer({type:"board",action:"pageSelect",p:2,m:""});return},setInterval:function(){console.log("board controler interval");boardControler.pageId++;boardControler.pageId>6&&(boardControler.pageId=0);toPage(boardControler.pageId)}},panelControler={activePanel:"board",nextPanel:null,selectNextPanel:function(){console.log("panelControler select next panel : "+panelControler.nextPanel);var n=panelControler.nextPanel;panelControler.prseAction(n)},parse:function(n){screenControler.requestForDisconnect();panelControler.prseAction2(n.action)},prseAction:function(n){screenControler.screenShareStatus||panelControler.prseAction2(n)},prseAction2:function(n){switch(n){case"board":panelControler.activeBoard();break;case"offic":officControler.start();break;case"Diagram":diagramControler.start();break;case"MathEditor":MathEditorControler.start();break;case"Develop":developControler.start();break;case"vPlayer":vPlayer.show();break;case"Conference":webRtcControler.start()}},activeBoard:function(){(panelControler.nextPanel="board",panelControler.activePanel!="board")&&(panelControler.activePanel="board",panelControler.disableAll(),document.getElementById("boardHtmlpanel").style.visibility="visible",$(".boardIcon").css("color","red"))},activePlayer:function(){(panelControler.nextPanel="vPlayer",panelControler.activePanel!="vPlayer")&&(panelControler.activePanel="vPlayer",panelControler.disableAll(),document.getElementById("vidioPlayerElement").style.display="block",document.getElementById("vidioPlayerElement").style.visibility="visible",$("vPlayerIconPanel").css("color","red"))},activeScreen:function(){panelControler.activePanel!="screen"&&(panelControler.activePanel="screen",panelControler.disableAll(),document.getElementById("screenShareElemnt").style.visibility="visible",$(".screanShareIcon").css("color","red"))},activeDiagram:function(){(panelControler.nextPanel="Diagram",panelControler.activePanel!="Diagram")&&(panelControler.activePanel="Diagram",panelControler.disableAll(),document.getElementById("diagramPanel").style.visibility="visible",$(".diagramIcon").css("color","red"))},activeOffic:function(){(panelControler.nextPanel="offic",console.log("panelControler : "+panelControler.activePanel),panelControler.activePanel!="offic")&&(panelControler.activePanel="offic",panelControler.disableAll(),document.getElementById("officPanel").style.visibility="visible",$(".officIcon").css("color","red"))},activeMathEditor:function(){(panelControler.nextPanel="MathEditor",panelControler.activePanel!="MathEditor")&&(panelControler.activePanel="MathEditor",panelControler.disableAll(),document.getElementById("MathEditorPanel").style.visibility="visible",$(".MathEditorIcon").css("color","red"))},activeDevelop:function(){(panelControler.nextPanel="Develop",panelControler.activePanel!="Develop")&&(panelControler.activePanel="Develop",panelControler.disableAll(),document.getElementById("developPanel").style.visibility="visible",$(".developPanelIcon").css("color","red"))},activeConference:function(){panelControler.activePanel!="Conference"&&(panelControler.activePanel="Conference",panelControler.disableAll(),baseLayout.parse(layout.id+"4"),$(".screanShareIcon").css("color","red"))},disableAll:function(){panelControler.activePanel!="Conference"&&panelControler.DisconnectConfrance();panelControler.activePanel!="player"&&panelControler.stopPlayer();$(".centerPanelItem").css("visibility","hidden");document.getElementById("vidioPlayerElement").style.display="none";diagramControler.isActive=0;MathEditorControler.isActive=0;officControler.isActive=0;webRtcControler.isActive=0;developControler.end();$(".farfar").css("color","black")},disconectScreenShare:function(){screenControler.screenShareStatus?screenControler.stopOwnScreenShare():screenControler.disconnectFromScreenShare()},stopPlayer:function(){vPlayer.isActive=0;try{vPlayer.stop()}catch{console.log("errror in stop player")}},DisconnectConfrance:function(){webRtcControler.isActive=0;layout.load()}},developControler={isActive:0,isLoad:0,ifram:document.getElementById("developFrame"),Interval:null,lastFile:"html",onClick:function(){if(developControler.isActive==1)developControler.end();else var n=mainApp.sendToServer({type:"panelControler",action:"Develop"})},start:function(){(panelControler.activeDevelop(),developControler.isActive)||(developControler.isActive=1,layout.id==1&&layout.sessionPanelPosetion==3&&baseLayout.parse("11"),developControler.isLoad||load_script_promise("/monaco/dist/monaco.bundle.js?v=1.01").then(function(){developControler.isLoad=1;window.loadComplate("meet_"+board.meetID);developControler.setConsole();developControler.selectLanguageFile()}),developControler.Interval=setInterval(developControler.frameRefresh,3e3))},end:function(){clearInterval(developControler.Interval);developControler.isActive=0},fileClick:function(n){var t={type:"Develop",action:"selectLanguage",lang:n},i=mainApp.sendToServer(t)},parse:function(n){var t=n.action;switch(t){case"selectLanguage":developControler.selectLanguage(n)}},selectLanguage:function(n){var t=n.lang;developControler.lastFile=t;developControler.selectLanguageFile()},selectLanguageFile:function(){document.getElementById("monaco-editor-tab-html").classList.remove("active");document.getElementById("monaco-editor-tab-java").classList.remove("active");document.getElementById("monaco-editor-tab-css").classList.remove("active");document.getElementById("nav-tab-html").classList.remove("active");document.getElementById("nav-tab-java").classList.remove("active");document.getElementById("nav-tab-css").classList.remove("active");document.getElementById("monaco-editor-tab-"+developControler.lastFile).classList.add("show");document.getElementById("monaco-editor-tab-"+developControler.lastFile).classList.add("active");document.getElementById("nav-tab-"+developControler.lastFile).classList.add("active");return},frameRefresh:function(){document.getElementById("developFrameConsole").innerHTML="";try{var n=window.example.htmlEditor.getValue(),t="<script>"+window.example.javaEditor.getValue()+"<\/script>",i="<style>"+window.example.cssEditor.getValue()+"<\/style>",r=i+n+t;developControler.replaceIframeContent(r)}catch(u){console.log(u)}},setConsole:function(){var n=developControler.ifram.contentWindow;n.console.log=function(n){var i=document.getElementById("developFrameConsole"),t=document.createElement("div");t.appendChild(document.createTextNode(n));i.appendChild(t)};n.console.warn=function(n){var i=document.getElementById("developFrameConsole"),t=document.createElement("div");t.appendChild(document.createTextNode(n));i.appendChild(t)};n.console.error=function(n){var i=document.getElementById("developFrameConsole"),t=document.createElement("div");t.style.color="red";t.appendChild(document.createTextNode(n));i.appendChild(t)};n.console.trace=function(n){var i=document.getElementById("developFrameConsole"),t=document.createElement("div");t.style.color="red";t.appendChild(document.createTextNode(n));i.appendChild(t)};n.console.info=function(n){var i=document.getElementById("developFrameConsole"),t=document.createElement("div");t.style.color="green";t.appendChild(document.createTextNode(n));i.appendChild(t)};developControler.ifram.onerror=function(n){var i=document.getElementById("developFrameConsole"),t=document.createElement("div");t.appendChild(document.createTextNode(n));i.appendChild(t)}},replaceIframeContent:function(n){developControler.ifram.src="about:blank";developControler.ifram.contentWindow.document.open();developControler.ifram.contentWindow.document.write(n);developControler.ifram.contentWindow.document.close()},editorChange:function(){console.log("editor change")}},diagramControler={isActive:0,diagramIframe:document.getElementById("diagramIframe"),lastMessage:null,getMessage:0,sendMessage:0,ui:"min",diagramClick:function(){if(diagramControler.isActive==1)diagramControler.end();else var n=mainApp.sendToServer({type:"panelControler",action:"Diagram"})},start:function(){(panelControler.activeDiagram(),diagramControler.isActive)||(diagramControler.isActive=1,diagramControler.diagramIframe.src==null||diagramControler.diagramIframe.src==undefined||diagramControler.diagramIframe.src==""?(console.log("layout.id "+layout.id+" layout.sessionPanelPosetion "+layout.sessionPanelPosetion),diagramControler.diagramIframe.src="/webapp/index.html?embed=0&ui="+diagramControler.ui+"&spin=0&proto=json",layout.id==1&&layout.sessionPanelPosetion==3&&baseLayout.parse("11")):diagramControler.lastMessage!=null&&diagramControler.diagramIframe.contentWindow.parentMessage(diagramControler.lastMessage))},setPermissen:function(n){diagramControler.ui=n==1?"atlas":"min";diagramControler.diagramIframe.src==null||diagramControler.diagramIframe.src==undefined||diagramControler.diagramIframe.src==""||(diagramControler.diagramIframe.src="/webapp/index.html?embed=0&ui="+diagramControler.ui+"&spin=0&proto=json")},end:function(){boardClick()},iframeMessage:function(n){if(!board.user.permission.diagram){console.log(" diagram permissen eerroorr");diagramControler.sendLastMessage();return}console.log("fff");console.log(n);var n={type:"diagram",m:n};diagramControler.getMessage==1?mainApp.sendToServer(n):diagramControler.sendLastMessage()},iframeMessageLoadComplate:function(){console.log("iframeMessageLoadComplate");diagramControler.sendMessage=1;diagramControler.sendLastMessage();setTimeout(()=>{diagramControler.getMessage=1,diagramControler.sendLastMessage()},2e3)},sendLastMessage:function(){diagramControler.lastMessage!=null&&diagramControler.diagramIframe.contentWindow.parentMessage(diagramControler.lastMessage)},parse:function(n){diagramControler.lastMessage=n;var t=n.meetInfo.userName;if(t==board.userName){console.log("this is my message");return}if(diagramControler.isActive==0){diagramControler.start();return}diagramControler.sendMessage!=0&&(console.warn("get diagram data from server ....."),console.log(n),diagramControler.diagramIframe.contentWindow.parentMessage(n))}},baseLayout={parse:function(n,t){switch(n){case"1":layout.setLayoutID();break;case"11":baseLayout.layoutChange(1,1);break;case"12":baseLayout.layoutChange(1,2);break;case"13":baseLayout.layoutChange(1,3);break;case"14":baseLayout.layoutChange(1,4);break;case"21":baseLayout.layoutChange(2,1);break;case"22":baseLayout.layoutChange(2,2);break;case"23":baseLayout.layoutChange(2,3);break;case"24":baseLayout.layoutChange(2,4)}layout.startRender(t)},render:function(){layout.resizeBoard();layout.setRightPanel()},layoutChange:function(n,t){layout.id=n;layout.sessionPanelPosetion=t},changLayouInputValue:function(){var n=document.getElementById("layoutDropDownSelect"),t=layout.id+""+layout.sessionPanelPosetion;n.value=t}},layout={id:1,rightPanelwidth:400,sessionPanelPosetion:1,leftPanelWidth:1,sessionPanelheight:180,centerVideoPanelWidth:400,menuStatus:0,element:{screenAndBoard:document.getElementById("screenAndBoard"),newVideosBox:document.getElementById("newVideosBox"),page_content_wrapper:document.getElementById("page-content-wrapper"),sidebar_wrapper:document.getElementById("sidebar-wrapper"),centerVideoPanel:document.getElementById("centerVideoPanel"),MainNavBar:document.getElementById("MainNavBar"),wrapper:document.getElementById("wrapper"),boardHtmlpanel:document.getElementById("boardHtmlpanel")},load:function(n){layout.setLayoutID();layout.startRender(n)},startRender:function(n){layout.setRightPanel(n);layout.setSessionPanelPosetion(layout.sessionPanelPosetion);layout.setWraperCss();layout.resizeBoard();layout.setMenu();baseLayout.changLayouInputValue();webRtcControler.CHANGEMYPEER()},setMenu:function(){var n=$("#MainBarMobile").width(),t=document.getElementById("MainBarDesctop");t.style.display=n>=600?"block":"none"},reLoad:function(n){layout.load(n)},setLayoutID:function(){if(webRtcControler.isActive){layout.id=n>1e3?1:2;return}layout.sessionPanelPosetion=1;var n=$(window).width(),t=$(window).height();n>1e3?(layout.id=1,layout.sessionPanelPosetion=1,n>1400&&(layout.sessionPanelPosetion=1)):(layout.id=2,layout.sessionPanelPosetion=t<700&&n>650?3:2)},setAutoSessionPanelPosetion:function(){var n=$(window).width();n>1e3?layout.setsessionPanelPosetion=1:layout.sessionPanelPosetion=2},setSessionPanelPosetion:function(n){layout.sessionPanelPosetion=n;layout.setWraperCss();n==3&&$("#videosBox").appendTo($("#centerVideoPanel"));n==1&&($("#videosBox").appendTo($("#lpanelVideo")),layout.id==2);(n==2||n==4)&&$("#videosBox").appendTo($("#newVideosBox"));layout.setRightPanel()},setLeftPanelWidth:function(){var n=$(window).width();layout.leftPanelWidth=layout.id==2?n:n-layout.rightPanelwidth},setRightPanel:function(n){n&&(layout.id==1?layout.openRightPanel():(layout.menuStatus=0,layout.element.sidebar_wrapper.style.display="none",layout.element.sidebar_wrapper.style.transform="translate(600px, 0px)"),layout.id==1&&layout.sessionPanelPosetion==3&&(layout.element.sidebar_wrapper.style.width="20%",layout.element.page_content_wrapper.style.width="60%"));layout.element.sidebar_wrapper.classList=layout.sessionPanelPosetion==1?"element3":"element2"},menuDisplayed:function(){layout.setWraperCss();return},setWraperCss:function(){var n="id_"+layout.id+" pos_"+layout.sessionPanelPosetion;layout.element.wrapper.classList=n},resizeBoard:function(){var n;bboard.changePage(bboard.pageID);return},resizeBoardW:function(n){var i=$(window).height()-67,u,f;layout.sessionPanelPosetion==2&&(layout.element.newVideosBox.style.height=layout.sessionPanelheight+"px",i=i-layout.sessionPanelheight);layout.sessionPanelPosetion==1;layout.leftPanelWidth=n;var e=layout.leftPanelWidth/board.width,r=i/board.height,t=e;r<t&&(t=r);u=document.getElementById("canvas");setZoom(t,u);board.zoom=t;f=$("#boardContainer").width();layout.element.boardHtmlpanel.style.width=f*board.zoom+"px"},prepareBoard:function(n,t){screenControler.screenShareStatus?screenControler.stopOwnScreenShare():screenControler.disconnectFromScreenShare();board.width=n;board.height=t;layout.resizeBoard()},marginBoard:function(){var i=$("#boardContainer").width(),n=i*board.zoom,t;layout.leftPanelWidth>n?(t=(layout.leftPanelWidth-n)/2,document.getElementById("boardHtmlpanel").style.marginLeft=t+"px"):document.getElementById("boardHtmlpanel").style.marginLeft="0px"},menuToggle:function(){chatService.unReadMessage=0;chatService.updateUnReadmessage();layout.menuStatus=!layout.menuStatus;layout.menuStatus?layout.openRightPanel():layout.closeRightPanel()},openRightPanel:function(){layout.element.sidebar_wrapper.style.display="block";setTimeout(()=>{layout.element.sidebar_wrapper.style.transform="translate(0px, 0px)"},500)},closeRightPanel:function(){layout.element.sidebar_wrapper.style.transform="translate(600px, 0px)";setTimeout(()=>{layout.menuStatus==0&&(layout.element.sidebar_wrapper.style.display="none")},1500)},resizeBoardtest1:function(){layout.id=layout.id==1?2:1;layout.menuDisplayed();layout.resizeBoard();return},resizeBoardtest2:function(){layout.setSessionPanelPosetion(2);layout.resizeBoard()},resizeBoardtest3:function(){var n=3;n=layout.sessionPanelPosetion==1?3:1;layout.setSessionPanelPosetion(n);layout.resizeBoard()},toggle_fullscreen:function(){console.log("fullscreen click");document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():(element=$("#bodybase").get(0),element.requestFullscreen?element.requestFullscreen():element.mozRequestFullScreen?element.mozRequestFullScreen():element.webkitRequestFullscreen?element.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):element.msRequestFullscreen&&element.msRequestFullscreen())}};document.getElementById("layoutDropDownSelect").onchange=function(){var n=document.getElementById("layoutDropDownSelect").value;baseLayout.parse(n,!0)};var MathEditorControler={isActive:0,MathEditorIframe:document.getElementById("MathEditorIframe"),lastMessage:"JGpqalxzdW17a30gClxcIFxwcm9ke3B9ICQ=",getMessage:0,sendMessage:0,ui:"min",iframSrc:"/VisualMathEditor/VisualMathEditor.html?style=black&runLocal",iframSrcDefult:"",iframSrcLimit:"/VisualMathEditor/jaxEditor/index.html",isLimit:1,permission:1,onClick:function(){if(MathEditorControler.isActive==1)MathEditorControler.end();else var n=mainApp.sendToServer({type:"panelControler",action:"MathEditor"})},start:function(n){(MathEditorControler.init(),panelControler.activeMathEditor(),MathEditorControler.isActive)||(MathEditorControler.isActive=1,n||MathEditorControler.MathEditorIframe.src==null||MathEditorControler.MathEditorIframe.src==undefined||MathEditorControler.MathEditorIframe.src==""?(MathEditorControler.MathEditorIframe.src=MathEditorControler.iframSrcDefult,layout.id==1&&layout.sessionPanelPosetion==3&&board.user.permission.MathEditor&&baseLayout.parse("11"),MathEditorControler.isLimit==0&&MathEditorControler.lastMessage!=null&&MathEditorControler.sendMessage&&setTimeout(()=>{MathEditorControler.MathEditorIframe.contentWindow.parentMessage(MathEditorControler.lastMessage)},1e3)):MathEditorControler.lastMessage!=null&&MathEditorControler.sendMessage&&MathEditorControler.MathEditorIframe.contentWindow.parentMessage(MathEditorControler.lastMessage))},end:function(){boardClick()},iframeMessage:function(n){if(!board.user.permission.MathEditor){console.log(" MathEditor permissen eerroorr");MathEditorControler.sendLastMessage();return}var n={type:"MathEditor",m:n};MathEditorControler.getMessage==1&&mainApp.sendToServer(n)},iframeMessageLoadComplate:function(){console.log("iframeMessageLoadComplate math");setTimeout(()=>{MathEditorControler.sendMessage=1,MathEditorControler.sendLastMessage(),MathEditorControler.getMessage=1},1e3)},sendLastMessage:function(){MathEditorControler.lastMessage!=null&&MathEditorControler.MathEditorIframe.contentWindow.parentMessage(MathEditorControler.lastMessage)},parse:function(n){MathEditorControler.lastMessage=n.m;var t=n.meetInfo.userName;if(t==board.userName){console.log("this is my message");return}if(MathEditorControler.isActive==0){MathEditorControler.start();return}MathEditorControler.sendMessage!=0&&(console.warn("get diagram data from server ....."),console.log(n),MathEditorControler.MathEditorIframe.contentWindow.parentMessage(n.m))},init:function(){var t=board.user.permission.MathEditor,n=$("#screenAndBoard").width();n>10?(MathEditorControler.iframSrcDefult=MathEditorControler.iframSrc,MathEditorControler.isLimit=0):(MathEditorControler.iframSrcDefult=MathEditorControler.iframSrcLimit,MathEditorControler.sendMessage=1,MathEditorControler.isLimit=1)},setPermissen:function(n){n!=MathEditorControler.permission&&(MathEditorControler.permission=n)}},mqttClient={client:null,isConnect:!1,meetStatus:!1,sendOption:{qos:2},serverTopic:"allmeet_"+board.serverID,connect:function(){var n={clientId:board.meetID+"_"+board.userName,username:board.nickName},t=board.mqttServer+"/mqtt";mqttClient.client=mqtt.connect(t,n);mqttClient.client.on("connect",function(){var n,u;if(mqttClient.isConnect)return window.location.reload(!0),!1;mqttClient.isConnect=!0;n={type:"join",reConecting:!1,role:board.publish};mainApp.sendToServer(n);var t="meet_send_"+board.serverID+"_"+board.meetID,i="user_"+board.meetID+"_"+board.userName,r='{"'+t+'": { "qos": 2 },"'+i+'": { "qos": 2 } }';mqttClient.client.subscribe(JSON.parse(r));console.warn("mqtt connect2 .. ");u=setInterval(mqttClient.interval2,5e3);setTimeout(()=>{var n=board.MeetStatus;(n==undefined||n==0)&&window.location.reload(!0)},2e4)});mqttClient.client.on("message",function(){});mqttClient.client.on("error",function(){});mqttClient.client.on("offline",function(){console.log("[MQTT] Connection offline");$.notify({message:board.translate.connectionLost},{placement:{from:"top",align:"left"},delay:3e3,type:"danger"})});mqttClient.client.on("reconnect",()=>{console.log("RECONNECT")});mqttClient.client.reconnecting=!0;mqttClient.client.options.reconnectPeriod=1e3},interval2:function(){if(signalmessenger.connection.state=="Disconnected"){signalmessenger.disconnectError();return}if(signalmessenger.connection.state=="Connected"){mqttClient.sendPing();return}},sendPing:function(){mainApp.sendToServer({type:"ping"})},ping:function(){mqttClient.sendPing();setTimeout(()=>{mqttClient.ping()},5e3)},send:function(n){try{signalmessenger.send(n)}catch(t){$.notify({message:board.translate.connectionLost},{placement:{from:"top",align:"left"},delay:3e3,type:"danger"})}},parse:function(n){var t=JSON.parse(n);if(t.type=="userManager"&&t.action=="reload"&&userManager.reload(t),t.type!="meetSatus"&&!mqttClient.meetStatus){messageQueue.add(t);return}mqttClient.runMessage(t)},runMessage:function(n){switch(n.type){case"board":CBoard.parse(n);break;case"mouse":CBoard.parseMouse(n);break;case"meetSatus":mainApp.handleMeetStatus(n);break;case"file":fileService.parse(n);break;case"activeFile":fileService.activeFile(n.fileID);break;case"textMessage":chatService.parse(n);break;case"userManager":userManager.parse(n);break;case"meetManager":meetManager.parse(n);break;case"quiz":quiz.parse(n);break;case"vPlayer":vPlayer.parse(n);break;case"panelControler":panelControler.parse(n);break;case"diagram":diagramControler.parse(n);break;case"MathEditor":MathEditorControler.parse(n);break;case"offic":officControler.parse(n);break;case"Develop":developControler.parse(n);break;case"record":recordControler.parse(n)}}},messageQueue={list:[],add:function(n){messageQueue.list.push(n)},get:function(){return messageQueue.list.shift()},isEmpty:function(){return messageQueue.list.length==0},readAll:function(){while(!messageQueue.isEmpty()){var n=messageQueue.get();mqttClient.runMessage(n)}}},officControler={isActive:0,officIframe:document.getElementById("office_form"),lastMessage:null,getMessage:0,sendMessage:0,file:"",fileList:[],ui:"min",firstLoad:1,wopiUri:board.officeServer,queryStr:board.user.permission.offic?"":"&permission=readonly",WordFile:["DOCX","DOC","DOT","ODT","FODT","RTF","TXT","HTML","HTM"],PowerPointFile:["PPTX","PPT","PPS","POT","ODP","FODP"],ExcelFile:["XLSX","ODS","FODS"],Click:function(){$("#fileOfficPanelModal").modal("toggle");return},start:function(n){if(officControler.file!=""&&(panelControler.activeOffic(),officControler.isActive=1,n||officControler.firstLoad)){officControler.firstLoad=0;var t=board.meetID+"_"+officControler.file,i="WOPISrc="+window.location.protocol+"//"+window.location.host+"/wopi/files/";officControler.officIframe.action=officControler.wopiUri+i+t+officControler.queryStr;layout.id==1&&layout.sessionPanelPosetion==3&&baseLayout.parse("11");officControler.submit()}},setPermissen:function(n){officControler.queryStr=n?"":"&permission=readonly"},end:function(){boardClick()},renderFileList:function(n){var i,u,t,r;officControler.fileList=n.filelist;officControler.file=n.activeFile;try{for(i=document.getElementById("officFiletable"),u=i.rows.length,t=0;t<u;t++)i.deleteRow(t)}catch(f){console.log(f)}for(t=0;t<officControler.fileList.length;t++)r=officControler.fileList[t],officControler.renderFileToHtmlElement(board.meetID,t+1,r.name,r.ext)},renderFileToHtmlElement:function(n,t,i){var o="/files/board/"+n+"/offic/"+i;selectSpan='<a class="officItem" href="#" onclick="officControler.activeFileServer(\''+i+'\')"  ><i class="fa fa-edit"  ><\/i> <\/a>';var e=document.getElementById("officFiletable"),s=e.rows.length,f=e.insertRow(s),r=f.insertCell(0),u="<span>"+t+"<\/span>";r.innerHTML=u;r=f.insertCell(1);r.innerHTML=selectSpan;r=f.insertCell(2);u="<span>"+i+"<\/span>";r.innerHTML=u;r=f.insertCell(3);u='<a href="'+o+'" target="_blank"><i class="fas fa-download"><\/i><\/a>';r.innerHTML=u},activeFileServer:function(n){var t={type:"offic",action:"fileSelect",fileName:n};mainApp.sendToServer(t)},parse:function(n){var r=n.action,u,i,t;if(r=="fileSelect"){u=n.wopiUri;officControler.wopiUri=u;i=n.fileName;officControler.file!=i||officControler.firstLoad?(officControler.file=i,officControler.start(1)):(officControler.isActive=1,panelControler.activeOffic());return}r=="uploadFile"&&(t=n.file,officControler.fileList.push(t),officControler.renderFileToHtmlElement(board.meetID,officControler.fileList.length,t.name,t.ext))},submit:function(){var t=document.getElementById("frameholder"),n=document.createElement("iframe");n.name="office_frame";n.id="office_frame";n.style.height="100%";n.style.width="100%";n.title="Office Online Frame";n.setAttribute("allowfullscreen","true");t.appendChild(n);document.getElementById("office_form").submit()}},quiz={currentValue:0,resultArray:null,quizData:null,isLoad:0,quizStr:null,start:function(){quiz.isLoad||quiz.loadScript();console.log("quiz start ");board.publish?$("#quizModal").modal("show"):$("#quizviewModal").modal("show");document.getElementById("quizMessage").innerText="";document.getElementById("quizViewMessage").innerText=""},Preparation:function(n){n!=null?($(".quizIconPanel").css("display","block"),quiz.quizCreate(n.m.d,!1)):board.publish&&$(".quizIconPanel").css("display","block")},save:function(){var n,u,t,o;if(document.getElementById("quizMessage").innerText="",n=document.getElementById("quizText").value,console.log(n),n==null||n.trim()==""){document.getElementById("quizMessage").innerText=board.translate.quiz_front_textEmpty;return}var i=document.getElementById("quizoption1").value,r=document.getElementById("quizoption2").value,f=document.getElementById("quizoption3").value,e=document.getElementById("quizoption4").value;if(i.trim()==""||r.trim()==""){document.getElementById("quizMessage").innerText=board.translate.quiz_front_optionEmpty;return}u={quizText:n,quizoption1:i,quizoption2:r,quizoption3:f,quizoption4:e};t={type:"quiz",action:"quizCreate",qdata:u};quiz.quizData=t;console.log(t);document.getElementById("quizFormSavaButton").value=board.translate.edit;o=mainApp.sendToServer(t);document.getElementById("quizMessage").innerText=board.translate.quiz_front_SendCompleted;setTimeout(()=>{document.getElementById("quizMessage").innerText=""},2e3)},sendAnswer:function(){console.log("sendAnswer");var n={type:"quiz",action:"answer",answer:quiz.currentValue},t=mainApp.sendToServer(n);document.getElementById("quizViewMessage").innerText=board.translate.quiz_front_answerSend;setTimeout(()=>{document.getElementById("quizViewMessage").innerText="",$("#quizviewModal").modal("hide")},2e3)},quizOptionHandleClick:function(n){quiz.currentValue=parseInt(n.value);document.getElementById("quizViewsendAnswer").style.display="inline-block";console.log(quiz.currentValue)},parse:function(n){console.warn(n);var t=n.action;switch(n.action){case"quizCreate":quiz.quizCreate(n,!0);break;case"result":quiz.result(n);break;case"showResultForAll":quiz.showResult(n);break;case"resultdetails":quiz.Resultdetails(n)}},quizCreate:function(n,t){var i,u;quiz.isLoad||quiz.loadScript();$(".quizIconPanel").css("display","block");quiz.quizData=n;i=n.qdata;u=i.quizText;document.getElementById("quizviewText").innerText=u;var o=i.quizoption1,s=i.quizoption2,f=i.quizoption3,e=i.quizoption4,r=" <div> "+u+" <\/div>";(r+=" <div> "+board.translate.option+" 1 : "+o+" <\/div>",r+=" <div> "+board.translate.option+" 2 :  "+s+" <\/div>",document.getElementById("quizoptionlable1").innerText=o,document.getElementById("quizoptionlable2").innerText=s,document.getElementById("quizoptionlable3").innerText=f,document.getElementById("quizoptionlable4").innerText=e,f.trim()==""?(document.getElementById("quizoptioninput3").style.display="none",document.getElementById("quizoptionlable3").style.display="none"):(document.getElementById("quizoptioninput3").style.display="inline-block",document.getElementById("quizoptionlable3").style.display="inline-block",r+=" <div> "+board.translate.option+" 3 :  "+f+" <\/div>"),e.trim()==""?(document.getElementById("quizoptioninput4").style.display="none",document.getElementById("quizoptionlable4").style.display="none"):(document.getElementById("quizoptioninput4").style.display="inline-block",document.getElementById("quizoptionlable4").style.display="inline-block",r+=" <div>  "+board.translate.option+" 4 : "+e+" <\/div>"),document.getElementById("quizviewTextResult").innerHTML=r,board.isRecorder)||(t&&$("#quizviewModal").modal("show"),board.publish&&quiz.quizFormCreate(n))},quizFormCreate:function(n){var t,i;quiz.quizData=n;t=n.qdata;i=t.quizText;document.getElementById("quizText").innerText=i;var r=t.quizoption1,u=t.quizoption2,f=t.quizoption3,e=t.quizoption4;document.getElementById("quizoption1").value=r;document.getElementById("quizoption2").value=u;document.getElementById("quizoption3").value=f;document.getElementById("quizoption4").value=e;document.getElementById("quizFormSavaButton").innerText=board.translate.edit},result:function(n){quiz.isLoad||quiz.loadScript();console.log(n);var t=n.rlist;quiz.resultArray=t;console.log(t);board.publish&&(quiz.updateResult(),document.getElementById("showResultForAllPanel").style.display="block")},showResult:function(n){var r,t;$("#quizResultModal").modal("show");r=n.rlist;quiz.resultArray=r;var i=" <div> "+board.translate.quiz_front_showResultTitle+" <\/div>",u=[],f=[];for(t=0;t<r.length;t++){var e=r[t],o=e[0].Value,s=e.length;u[t]=board.translate.option+" "+o;f[t]=s;i+=" <div>";i+=board.translate.option+" "+o+" : "+s+" "+board.translate.Person;i+=" <div>"}document.getElementById("quizResult").innerHTML=i;document.getElementById("quizviewResult").innerHTML=i;quiz.drawChart(u,f);board.isRecorder&&setTimeout(()=>{$("#quizResultModal").modal("hide")},15e3)},GetResultdetails:function(){var n=mainApp.sendToServer({type:"quiz",action:"resultdetails"})},Resultdetails:function(n){var r,t,i,u;for(quiz.updateResult(),r=n.dlist,t=" <div> "+board.translate.quiz_front_ResultdetailsTitle+" <\/div>",i=0;i<r.length;i++)u=r[i],t+=" <div>",t+=u,t+=" <div>";document.getElementById("quizResult").innerHTML+=t},updateResult:function(){for(var i=quiz.resultArray,n=" <div>"+board.translate.quiz_front_showResultTitle+"  <\/div>",t=0;t<i.length;t++){var r=i[t],u=r[0].Value,f=r.length;n+=" <div>";n+=board.translate.option+" "+u+" : "+f+" "+board.translate.Person;n+=" <div>"}document.getElementById("quizResult").innerHTML=n},showResultForAll:function(){var n=mainApp.sendToServer({type:"quiz",action:"showResultForAll"});document.getElementById("quizMessage").innerText=board.translate.quiz_front_publishComplate},loadScript:function(){var n,t;console.log("scrip load start ........");n=document.createElement("script");n.onload=function(){quiz.isLoad=1;console.log("script is load .........")};n.src="/js/chartist.min.js";document.head.appendChild(n);t="/css/chartist.min.css";document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href=\''+t+"' />")},drawChart:function(n,t){new Chartist.Bar(".ct-chart",{labels:n,series:t},{distributeSeries:!0})}},screenControler={screenShareStatus:0,localScreenShareStatus:0,screenShareRemoteStatus:0,screanShareRecquestTime:null,screanShareClick:function(){appActions.shareScreen();return},startScreenShare:function(){if(!screenControler.screenShareRemoteStatus){iconDisablVidu(4e3,MainNavBar);iconDisablVidu(4e3,iconViduPanel);var n=new Date;screenControler.screanShareRecquestTime=n.getTime();webrtClient.startScreen();return}},stopOwnScreenShare:function(){webrtClient.stopScreen()},stopScsh1000:function(){webrtClient.stopScreen();return},requestForDisconnect:function(){if(screenControler.screenShareStatus){const n=currentRoom.localParticipant.isScreenShareEnabled;n&&appActions.shareScreen()}},disconnectFromScreenShare:function(){screenControler.screenShareStatus&&(screenControler.screenShareStatus=0)},connectToScreenShare:function(){screenControler.screenShareStatus||(screenControler.screenShareStatus=1,panelControler.activeScreen())}},isTabActive;window.onfocus=function(){isTabActive=!0};window.onblur=function(){isTabActive=!1};bboard={bboard:null,fboard:null,fileList:null,dic:{},fileID:0,pageID:0,page:null,activePage:function(){return},changePage:function(n){var i,r,f,o,e,s,u;if(bboard.fileList!=null&&bboard.dic[bboard.fileID]!=undefined){if(bboard.pageID=n,i=bboard.dic[bboard.fileID][n],i==undefined){console.error("page not found : "+n);return}for(resizeNewBoard(),r=0;r<i.length;r++){f=i[r];try{idroo.board.restoreChange(f.m)}catch(h){console.error("restoreChange");console.log(f.m)}}boardControler.sendMessage=1;document.getElementById("inputGroupSelect04").value=n;o=document.getElementById("canvas");let t=o.firstChild;if(e=t.getContext("2d"),e.clearRect(0,0,t.width,t.height),bboard.fileID!=0){s=Number(n)+1;u="/files/board/"+board.meetID+"/pic/"+bboard.fileID+"/"+s+".jpg";idroo.board.setBackground(u);return;let i}else t.style.backgroundImage="none"}},clear:function(){return;var n;const t=n.getContext("2d")},addC:function(n){var t={};t.str={};t.str.d=n.d;bboard.dic[n.d.fileID][n.d.num].push(t)},test:function(){},getBBoard:function(n){for(var u,i,f,r,e,t=0;t<n.length;t++)for(u=n[t],i=0;i<u.length;i++)for(f=u[i],r=0;r<f.length;r++)e=f[r],e.str=JSON.parse(e.str);bboard.bboard=n},setFileList:function(){return},mlistToDic:function(n){var i;for(bboard.createNewDic(),i=0;i<n.length;i++){var t=JSON.parse(n[i]),u=t.f,r=t.p;try{bboard.dic[u][r].push(t)}catch(f){console.error("push to dic");console.log(t)}}if(n.length==0)bboard.changePage(0);else{var t=JSON.parse(n[n.length-1]),u=t.f,r=t.p;bboard.changFile(u);try{bboard.changePage(r)}catch(f){console.error("pageselect");console.log(r)}}},createNewDic:function(){for(var r,u,t,i=bboard.fileList,n=0;n<i.length;n++)for(r=i[n].inRoomID,bboard.dic[r]={},u=i[n].pageCount,t=0;t<u;t++)bboard.dic[r][t]=[]},dicTodic:function(n){for(var f,o,t,e,i,s,u=bboard.fileList,r=0;r<u.length;r++)for(f=u[r].inRoomID,o=u[r].pageCount,t=0;t<o;t++)for(e=n[f][t],i=0;i<e.length;i++)s=e[i],n[f][t][i].str=JSON.parse(s.str);bboard.dic=n},addFileToDic:function(n){var i=n.inRoomID,r,t;for(bboard.fileList.push(n),r=n.pageCount,bboard.dic[i]={},t=0;t<r;t++)bboard.dic[i][t]=[];bboard.activePage(i,0)},reciveMessage:function(n){var i=n.f,t=n.p,u=n.meetInfo.userName,r=n.action;if(r=="fileSelect"){boardControler.sendMessage=0;bboard.changFile(i);try{bboard.changePage(0)}catch(f){console.error("pageselect reciveMessage 0");console.log(n)}boardControler.sendMessage=1;return}if(r=="pageSelect"){if(boardControler.sendMessage=0,t!=bboard.pageID)try{bboard.changePage(t)}catch(f){console.error("pageselect reciveMessage 2");console.log(n)}boardControler.sendMessage=1;return}if(i!=bboard.fileID||t!=bboard.pageID){console.error("pageselect reciveMessage 3");console.log(n);return}try{bboard.dic[i][t].push(n)}catch(f){console.error("reciveMessage 1");console.log(n);return}if(u!=board.userName){try{idroo.board.restoreChange(n.m)}catch(f){console.error("reciveMessage 2")}return}},changFile:function(n){var t,i;for(board.zoomScale2=1,bboard.fileID=n,t=0;t<bboard.fileList.length;t++)bboard.fileList[t].inRoomID==n&&(i=bboard.fileList[t],board.width=i.width,board.height=i.height,resizeNewBoard(),createBoardPaging(i.pageCount))},serverMessDicMapping:function(){console.log(bboard.dic);bboard.changePage(0)}};playerBoard={meet:null,data:null,p:0,w:0,play:function(){var t=playerBoard.data,n;playerBoard.p=playerBoard.data[0].d.date;n=setInterval(playerBoard.interval,100)},interval:function(){playerBoard.int2(playerBoard.p)},int2:function(n){var t=playerBoard.data[playerBoard.w++];t.d.date<n?(playerBoard.handleData(t.d.d),playerBoard.int2(n)):(playerBoard.w--,playerBoard.p++,console.warn(n))},handleData:function(n){whiteboard.handleEventsAndData(n,!0)}};$(document).ready(function(){var n,t,i,r,u;if($(".menu-toggle").click(function(){layout.menuToggle()}),layout.load(),resizeNewBoard(),board.isToch=is_touch_enabled(),board.isRecorder)mainApp.start();else{const t=new URL(window.location).searchParams;n=t.get("x");n==0?mainApp.start():$("#deviceUnpublisherModal").modal("toggle")}_viduModulStart();t=document.getElementById("screenAndBoard");new ResizeSensor(t,function(){layout.resizeBoard();webRtcControler.CHANGEMYPEER()});i=document.getElementById("centerVideoPanel");new ResizeSensor(i,function(){webRtcControler.CHANGEMYPEER()});r=layout.element.sidebar_wrapper;new ResizeSensor(r,function(){webRtcControler.CHANGEMYPEER()});$("#stroke-width-slider").slider().set(5,1);u=function(){return 0}});window.addEventListener("orientationchange",function(){console.warn("orientationchange");layout.reLoad(!0)});window.onresize=reportWindowSize;MainNavBar=document.getElementById("MainNavBar");document.getElementById("boardContainer").addEventListener("touchmove",function(){});vPlayer={isActive:0,player:null,interval:null,url:null,isLoad:0,ytIsLoad:0,admin:null,firstLoad:async function(n){var t,i;(board.publish&&$(".vPlayerIconPanel").css("display","block"),t=n.m,t!=null)&&(vPlayer.url=t.url,document.getElementById("externalVideoInput").value=t.url,n.isActive&&(i=t.meetInfo.userName,i==board.userName&&await vPlayer.startPlay()))},show:function(){vPlayer.isActive=1;panelControler.activePlayer()},start:async function(n){if(console.log("start .."),console.log(vPlayer.url),!vPlayer.isLoad){var t="/css/video-js.css";await load_script_promise("/js/video3.min.js").then(function(){vPlayer.isLoad=1;document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href=\''+t+"' />")})}vPlayer.url.includes("youtube.com")&&vPlayer.ytIsLoad==0&&await load_script_promise("/js/youtube.js").then(function(){vPlayer.ytIsLoad=1;console.log("youtube js load")});vPlayer.isActive=1;n&&vPlayer.show();vPlayer.player=videojs("myVideo");vPlayer.url.includes("youtube.com")?vPlayer.player.src({src:vPlayer.url,type:"video/youtube"}):vPlayer.player.src(vPlayer.url)},stop:function(){vPlayer.interval!=null&&(clearInterval(vPlayer.interval),vPlayer.interval=null);vPlayer.player!=null&&vPlayer.player.pause()},Preparation:async function(){$("#externalVideoModal").modal("show");document.getElementById("videoPlayerButton").style.display=vPlayer.url!=null?"block":"none";document.getElementById("externalVideoMessage").innerText="";vPlayer.url!=null&&(document.getElementById("externalVideoInput").value=vPlayer.url)},startPlayToServer:async function(){var n=document.getElementById("externalVideoInput").value,i;if(n.trim()==""||n==null){document.getElementById("externalVideoMessage").innerText=board.translate.player_emptyInputMessage;return}var r=mainApp.sendToServer({type:"panelControler",action:"vPlayer"}),t={type:"vPlayer",action:"setAdmin",mode:"startPlay",time:0,url:n};console.log(t);i=mainApp.sendToServer(t)},continuPlayToServer:async function(){var n=document.getElementById("externalVideoInput").value;if(n.trim()==""||n==null){document.getElementById("externalVideoMessage").innerText=board.translate.player_emptyInputMessage;return}var i=mainApp.sendToServer({type:"panelControler",action:"vPlayer"}),t={type:"vPlayer",action:"setAdmin",mode:"continuPlay",time:0,url:vPlayer.url},r=mainApp.sendToServer(t)},startPlay:async function(){if(console.log("startPlay"),vPlayer.url.trim()=="error"){document.getElementById("externalVideoMessage").innerText="eroor in get file";return}panelControler.nextPanel="player";$("#externalVideoModal").modal("hide");console.log(vPlayer.url);var n={type:"vPlayer",action:"startPlay",time:0,url:vPlayer.url},t=mainApp.sendToServer(n);await vPlayer.start();vPlayer.setEvent();vPlayer.interval=setInterval(vPlayer.getStatus,5e3)},continuPlay:function(){$("#externalVideoModal").modal("hide");vPlayer.show();var n={type:"vPlayer",action:"continuPlay",time:0,url:vPlayer.url},t=mainApp.sendToServer(n);vPlayer.interval=setInterval(vPlayer.getStatus,5e3)},setEvent:function(){vPlayer.player.on("play",function(){var n={type:"vPlayer",action:"play",time:vPlayer.player.currentTime(),url:vPlayer.url},t=mainApp.sendToServer(n)});vPlayer.player.on("pause",function(){var n={type:"vPlayer",action:"pause",time:vPlayer.player.currentTime(),url:vPlayer.url};vPlayer.sendMessage(n)});vPlayer.player.on("seeking",function(){var n={type:"vPlayer",action:"seeking",time:vPlayer.player.currentTime(),url:vPlayer.url};vPlayer.sendMessage(n)});vPlayer.player.on("seeked",function(){var n={type:"vPlayer",action:"seeked",time:vPlayer.player.currentTime(),url:vPlayer.url};vPlayer.sendMessage(n)})},sendMessage:function(n){if(vPlayer.interval==null){console.log("player interval is null ");return}var t=mainApp.sendToServer(n)},getStatus:function(){var n={type:"vPlayer",action:"setTime",time:vPlayer.player.currentTime(),url:vPlayer.url};n.status=vPlayer.player.paused()?"paused":"play";mainApp.sendToServer(n)},parse:async function(n){var i=n.action,r=n.meetInfo.userName,t;if(i=="setAdmin"){await vPlayer.setAdminParse(n);return}if(board.userName!=r){t=n.url;vPlayer.url!=null&&vPlayer.url==t&&vPlayer.isActive||(vPlayer.url=t,await vPlayer.start());switch(n.action){case"play":vPlayer.play(n);break;case"pause":vPlayer.pause(n);break;case"seeking":vPlayer.seeking(n);break;case"setTime":vPlayer.setStatus(n);break;case"startPlay":panelControler.nextPanel="player";break;case"continuPlay":panelControler.nextPanel="player"}}},setAdminParse:async function(n){if(clearInterval(vPlayer.interval),vPlayer.interval=null,vPlayer.admin=n.meetInfo.userName,vPlayer.admin!=board.userName){console.warn("vPlayer.admin :"+vPlayer.admin);return}vPlayer.url=n.url;var t=n.mode;console.log(t);t=="startPlay"?await vPlayer.startPlay():vPlayer.continuPlay()},play:function(n){var t=n.time;vPlayer.player.currentTime(t);vPlayer.player.play()},pause:function(n){var t=n.time;vPlayer.player.currentTime(t);vPlayer.player.pause()},seeking:function(n){var t=n.time;vPlayer.player.currentTime(t)},setStatus:function(n){var i=n.time,r=vPlayer.player.currentTime,u=Math.abs(i-r),t;u<20||(t=n.status,t=="play"?vPlayer.play(n):vPlayer.pause(n))},loadScript:async function(){console.log("load script call");await sleep(2e3);vPlayer.isLoad||await vPlayer.loadScript();console.log("load script call 2222222222222222222222222222222222222222222");return},loadScriptForce:function(){console.log("scrip load start ........");var n=document.createElement("script");n.onload=function(){vPlayer.isLoad=1;console.log("script is load .........")};n.src="/js/video.min.js";document.head.appendChild(n);document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="/css/video-js.css" />')}};let webRtcControler={isActive:0,lastChangeTime:Date.now(),isConnect:0,screenShareSuport:navigator.mediaDevices&&"getDisplayMedia"in navigator.mediaDevices,load:function(){var n;appActions.connectWebrtc(board.mediaServer,board.token);return},click:function(){var n=mainApp.sendToServer({type:"panelControler",action:"Conference"})},start:function(){panelControler.activeConference();webRtcControler.isActive=1},parse:function(){},onConnectToRoom:function(){webRtcControler.isConnect=1;$$$("iconPanelVidu").style.display="block"},onDisonnectToRoom:function(){webRtcControler.isConnect=0;$$$("iconPanelVidu").style.display="none"},permission:function(n){var t=document.getElementById("mute-audio-span"),i=document.getElementById("mute-video-span"),r=document.getElementById("mute-screen-span");t&&(n.audio?t.style.display="inline":(t.style.display="none",appActions.disableAudio()));i&&(n.video?i.style.display="inline":(i.style.display="none",appActions.disableVideo()));r&&(n.screen&&webRtcControler.screenShareSuport?r.style.display="inline":(r.style.display="none",appActions.disableScreen()))},firstPermisson:function(){var n=board.user.permission;webRtcControler.permission(n)},CHANGEMYPEER:function(){var n=Date.now(),t=n-webRtcControler.lastChangeTime,i=Math.floor(t/1e3);if(!(i<1)){webRtcControler.lastChangeTime=n;setTimeout(()=>{try{appActions.setVideoElementSize1()}catch{console.warn("window.CLIENT is null")}},150);setTimeout(()=>{try{appActions.setVideoElementSize1()}catch{console.warn("window.CLIENT is null")}},1e3);return}},startScreen:function(){webRtcControler.click();return},stopScreen:function(){return}};recordControler={isActive:0,element:{recordStatus:document.getElementById("recordStatus"),recordButton:document.getElementById("recordButton"),recordFileList:document.getElementById("recordFileList"),recordRequstMessage:document.getElementById("recordRequstMessage"),meetLiveDiv:document.getElementById("meetLiveDiv")},onClick:function(){$("#recordModal").modal("toggle")},request:function(){var t=window.location.protocol+"//"+window.location.host,n={type:"click",meetID:board.meetID,host:t},i={type:"record",meetID:board.meetID};console.log(n);try{mqttClient.client.publish("recorder_get_"+board.serverID,JSON.stringify(n),mqttClient.sendOption);recordControler.element.recordRequstMessage.innerHTML="your request send . wait for it to be processed ...";setTimeout(()=>{recordControler.element.recordRequstMessage.innerHTML=""},5e3)}catch(r){console.log("error in record request")}},getFileListRequest:function(){var n="user_"+board.meetID+"_"+board.userName,t={type:"getFileListRequest",meetID:board.meetID,topic:n};mqttClient.client.publish("recordMeet_"+board.serverID,JSON.stringify(t),mqttClient.sendOption)},setRecordeStatus:function(n){var t;n?(recordControler.isActive=1,t=document.getElementById("recordIcon"),t&&(t.style.color="red",t.title="click to stop recording"),recordControler.element.recordButton.textContent="click to stop recording",recordControler.element.recordStatus.textContent="recording",board.live&&(recordControler.element.meetLiveDiv.style.display="block")):(recordControler.isActive=0,t=document.getElementById("recordIcon"),t&&(t.style.color="black",t.title="click to start recording"),recordControler.element.recordButton.textContent="click to start recording",recordControler.element.recordStatus.textContent="stop",board.live&&(recordControler.element.meetLiveDiv.style.display="none"))},getFileList:function(n){var i=n.fileList,t,r;if(i){console.log(i);t='<table style="width:100%">';t+="<tr>";t+="<td> id <\/td>";t+="<td> open <\/td>";t+="<td> name <\/td>";t+="<\/tr>";r=1;i.forEach(n=>{var i=board.recordServer+n;t+="<tr>";t+="<td> "+r+" <\/td>";t+='<td> <a target="_blank" href="'+i+'">open<\/a> <\/td>';t+="<td> "+n+" <\/td>";t+="<\/tr>";r++});t+="<\/table>";recordControler.element.recordFileList.innerHTML=t;return}},parse:function(n){var t=n.action;switch(t){case"fileList":recordControler.getFileList(n)}}};signalmessenger={connected:0,connection:0,connect:function(){signalmessenger.connection=(new signalR.HubConnectionBuilder).configureLogging(signalR.LogLevel.None).withUrl("/chatHub?meetid="+board.meetID+"&userid="+board.userName).build();signalmessenger.start();signalmessenger.connection.on("ReceiveMessage",function(n){mqttClient.parse(n)});signalmessenger.connection.onreconnected(()=>{console.warn("reconnected")});signalmessenger.connection.onclose(()=>{console.warn("dicxonnrct"),appActions.disconnectRoom(),signalmessenger.disconnectError(),setTimeout(()=>{signalmessenger.start()},1e3)})},start:function(){console.log("try connect to wss ............");signalmessenger.connection.start({transport:"webSockets"}).then(function(){if(console.warn("signal  start .........................."),signalmessenger.connected&&signalmessenger.connectionNotify(),!signalmessenger.connected)var n=setInterval(mqttClient.interval2,5e3);signalmessenger.connected=1}).catch(function(n){console.error(n.toString());setTimeout(function(){signalmessenger.start()},3e3)})},send:function(n){try{signalmessenger.connection.invoke("SendMessage",n)}catch(t){console.error(t);signalmessenger.disconnectError()}},close:function(){if(signalmessenger.connection.state=="Disconnected"){signalmessenger.start();console.log("Disconnected");return}if(signalmessenger.connection.state=="Connected"){console.log("close");signalmessenger.connection.stop().then(function(){console.log("Closed")});return}},disconnectError:function(){$.notify({message:board.translate.connectionLost},{placement:{from:"top",align:"left"},delay:2e3,type:"danger"})},connectionNotify:function(){$.notify({message:board.translate.ServerConnection},{placement:{from:"top",align:"left"},delay:2500,type:"success"})}};